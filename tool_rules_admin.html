<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Cloudflare è¶…ç´šæ§åˆ¶å°ï½œçµ±ä¸€çª—å£</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root{
      --bd: rgba(15,23,42,.10);
      --glass: rgba(255,255,255,.84);
      --glass2: rgba(255,255,255,.72);
      --muted: rgba(15,23,42,.58);
    }
    body{
      font-family: ui-sans-serif, system-ui, "Microsoft JhengHei";
      background:
        radial-gradient(1200px 600px at 10% 0%, rgba(59,130,246,.18), transparent 55%),
        radial-gradient(950px 520px at 90% 12%, rgba(16,185,129,.16), transparent 55%),
        radial-gradient(1000px 650px at 50% 110%, rgba(245,158,11,.14), transparent 60%),
        #f8fafc;
    }
    .glass{ background:var(--glass); border:1px solid var(--bd); backdrop-filter: blur(12px); box-shadow: 0 18px 55px rgba(15,23,42,.10); }
    .glass2{ background:var(--glass2); border:1px solid var(--bd); backdrop-filter: blur(10px); box-shadow: 0 10px 26px rgba(15,23,42,.06); }
    .btn{ border:1px solid var(--bd); background:#fff; }
    .btn:hover{ background:#f1f5f9; }
    .btn:active{ transform: translateY(1px); }
    .btnP{
      border:1px solid rgba(37,99,235,.18);
      background: linear-gradient(135deg, rgba(14,165,233,.16), rgba(37,99,235,.14));
    }
    .btnP:hover{ filter: brightness(1.02); background: linear-gradient(135deg, rgba(14,165,233,.20), rgba(37,99,235,.18));}
    .inp{
      width:100%;
      border-radius:16px;
      border:1px solid var(--bd);
      background: rgba(255,255,255,.90);
      padding:12px 14px;
      outline:none;
    }
    .inp:focus{ box-shadow: 0 0 0 4px rgba(59,130,246,.12); border-color: rgba(59,130,246,.35); }
    .kbd{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      border:1px solid var(--bd);
      background: rgba(255,255,255,.75);
      padding:.12rem .45rem;
      border-radius: .7rem;
      font-size: .82em;
    }
    pre{ white-space: pre-wrap; word-break: break-word; }
    .pill{
      border:1px solid var(--bd);
      border-radius:999px;
      padding:6px 10px;
      font-size:12px;
      color: rgba(15,23,42,.70);
      background: rgba(255,255,255,.70);
    }
    .tab{
      border:1px solid transparent;
      border-radius: 16px;
      padding:10px 12px;
      font-weight: 800;
      color: rgba(15,23,42,.78);
      background: rgba(255,255,255,.55);
    }
    .tab:hover{ background: rgba(255,255,255,.80); }
    .tab.active{
      background: #0f172a;
      color: #fff;
      border-color: rgba(15,23,42,.08);
      box-shadow: 0 14px 36px rgba(2,6,23,.18);
    }
    .small{ font-size:12px; color: var(--muted); }
    .divider{ height:1px; background: rgba(15,23,42,.10); }
    .modal-back{ background: rgba(2,6,23,.55); }
  </style>
</head>

<body class="min-h-screen">
  <div class="mx-auto max-w-7xl px-4 pt-5 pb-24 space-y-4">

    <!-- Header -->
    <div class="glass rounded-3xl px-5 py-4 flex items-start justify-between gap-3">
      <div class="min-w-0">
        <div class="text-lg md:text-xl font-extrabold text-slate-900 truncate">Cloudflare è¶…ç´šæ§åˆ¶å°ï½œçµ±ä¸€çª—å£</div>
        <div class="text-sm text-slate-600 truncate">
          æ‰€æœ‰å·¥å…·éƒ½å¾é€™è£¡æ§åˆ¶ï¼šWorker API / KV / å•å·è¦å‰‡ / æ¸¬è©¦ç”¢å ±å‘Š / å·¥å…·é€£çµç®¡ç†
        </div>
      </div>
      <div class="flex items-center gap-2 flex-wrap">
        <span id="pillStatus" class="pill">â€”</span>
        <button class="btn text-sm px-4 py-2 rounded-2xl" onclick="UI.openHelp()">æ•™å­¸</button>
      </div>
    </div>

    <!-- Tabs + Settings Bar -->
    <div class="grid lg:grid-cols-12 gap-4">
      <!-- Sidebar -->
      <aside class="lg:col-span-3 glass2 rounded-3xl p-4 space-y-3">
        <div class="text-slate-900 font-extrabold">åŠŸèƒ½é¸å–®</div>
        <div class="grid gap-2">
          <button class="tab active" data-tab="overview">ç¸½è¦½</button>
          <button class="tab" data-tab="tools">å·¥å…·é€£çµ</button>
          <button class="tab" data-tab="survey">å•å·è¦å‰‡</button>
          <button class="tab" data-tab="report">ç”¢å ±å‘Šæ¸¬è©¦</button>
          <button class="tab" data-tab="kv">KV ç®¡ç†</button>
          <button class="tab" data-tab="settings">è¨­å®š / åŒ¯å…¥åŒ¯å‡º</button>
          <button class="tab" data-tab="log">æ—¥èªŒï¼ˆLogï¼‰</button>
        </div>

        <div class="divider my-2"></div>

        <div class="space-y-2">
          <div class="text-sm font-extrabold text-slate-900">çµ±ä¸€ API è¨­å®š</div>

          <div class="space-y-1">
            <div class="text-xs text-slate-600">Worker Base</div>
            <input id="base" class="inp" placeholder="https://api.xxx.workers.dev" />
          </div>

          <div class="space-y-1">
            <div class="text-xs text-slate-600">ADMIN_KEYï¼ˆéœ€è¦å¯«å…¥æ‰å¡«ï¼‰</div>
            <input id="adminKey" type="password" class="inp" placeholder="X-Admin-Key" />
          </div>

          <div class="flex gap-2">
            <button class="btn btnP px-4 py-2 rounded-2xl text-sm font-extrabold w-full" onclick="API.ping()">æ¸¬è©¦é€£ç·š</button>
            <button class="btn px-4 py-2 rounded-2xl text-sm w-full" onclick="CFG.save()">ä¿å­˜</button>
          </div>

          <div class="small">
            é€£ç·šæ¸¬è©¦æœƒæ‰“ï¼š<span class="kbd">GET /health</span>
          </div>
        </div>
      </aside>

      <!-- Main -->
      <main class="lg:col-span-9 space-y-4">

        <!-- OVERVIEW -->
        <section id="view-overview" class="glass2 rounded-3xl p-5 space-y-4">
          <div class="flex items-start justify-between gap-3 flex-wrap">
            <div>
              <div class="text-base md:text-lg font-extrabold text-slate-900">ç¸½è¦½</div>
              <div class="small">ä½ åªéœ€è¦ä¸€å€‹å…¥å£ï¼Œæ‰€æœ‰å·¥å…·éƒ½ç”¨åŒä¸€å€‹ Worker çµ±ä¸€çª—å£ã€‚</div>
            </div>
            <div class="flex gap-2 flex-wrap">
              <button class="btn px-4 py-2 rounded-2xl text-sm" onclick="UI.go('tools')">ç®¡ç†å·¥å…·é€£çµ</button>
              <button class="btn px-4 py-2 rounded-2xl text-sm" onclick="UI.go('survey')">ç®¡ç†å•å·è¦å‰‡</button>
              <button class="btn px-4 py-2 rounded-2xl text-sm" onclick="UI.go('kv')">KV ç®¡ç†</button>
            </div>
          </div>

          <div class="grid md:grid-cols-3 gap-3">
            <div class="glass rounded-3xl p-4">
              <div class="text-sm font-extrabold text-slate-900">ç›®å‰ Worker Base</div>
              <div class="mt-2 text-sm text-slate-700 break-words" id="ovBase">â€”</div>
              <div class="small mt-2">ä¾†æºï¼šlocalStorageï¼ˆé€™é ä¿å­˜ï¼‰</div>
            </div>
            <div class="glass rounded-3xl p-4">
              <div class="text-sm font-extrabold text-slate-900">å·¥å…·æ•¸é‡</div>
              <div class="mt-2 text-2xl font-extrabold text-slate-900" id="ovTools">0</div>
              <div class="small mt-2">å¯è‡ªç”±æ–°å¢ä»»ä½•ä½ç½®çš„ URL</div>
            </div>
            <div class="glass rounded-3xl p-4">
              <div class="text-sm font-extrabold text-slate-900">å¿«é€Ÿå‹•ä½œ</div>
              <div class="mt-3 grid gap-2">
                <button class="btn btnP px-4 py-2 rounded-2xl text-sm font-extrabold" onclick="API.rulesGet()">è®€è¦å‰‡</button>
                <button class="btn px-4 py-2 rounded-2xl text-sm" onclick="API.submit()">æ¸¬è©¦ç”¢å ±å‘Š</button>
              </div>
            </div>
          </div>

          <div class="glass rounded-3xl p-4">
            <div class="text-sm font-extrabold text-slate-900">ä½ ç¾åœ¨ Worker ç›®å‰æ”¯æ´çš„è·¯ç”±ï¼ˆä¾ä½ è²¼çš„ codeï¼‰</div>
            <div class="mt-2 text-sm text-slate-700 leading-relaxed">
              <div>âœ… <span class="kbd">GET /health</span></div>
              <div>âœ… <span class="kbd">POST /survey/rules/get</span></div>
              <div>âœ… <span class="kbd">POST /survey/rules/set</span>ï¼ˆéœ€è¦ <span class="kbd">X-Admin-Key</span>ï¼Œä½ æœ‰è¨­å®š ADMIN_KEY æ‰æœƒé©—è­‰ï¼‰</div>
              <div>âœ… <span class="kbd">POST /survey/submit</span></div>
              <div class="small mt-2">KV ç®¡ç†ï¼ˆ/api/kv/*ï¼‰å¦‚æœä½  Worker é‚„æ²’åšï¼ŒæŒ‰ä¸‹å»æœƒ 404ï¼ŒLog æœƒæç¤ºè¦è£œè·¯ç”±ã€‚</div>
            </div>
          </div>
        </section>

        <!-- TOOLS -->
        <section id="view-tools" class="hidden glass2 rounded-3xl p-5 space-y-4">
          <div class="flex items-start justify-between gap-3 flex-wrap">
            <div>
              <div class="text-base md:text-lg font-extrabold text-slate-900">å·¥å…·é€£çµï¼ˆä½ å·¥å…·æ”¾å“ªè£¡éƒ½è¡Œï¼‰</div>
              <div class="small">é€™è£¡åªåšã€Œå½™æ•´å…¥å£ã€ã€‚ä½ å¯ä»¥æ–°å¢ä»»ä½• URLï¼ˆGitHub Pages ä»»æ„è·¯å¾‘ / å¤–éƒ¨ç¶²å€ï¼‰ã€‚</div>
            </div>
            <div class="flex gap-2 flex-wrap">
              <button class="btn btnP px-4 py-2 rounded-2xl text-sm font-extrabold" onclick="TOOLS.openAdd()">ï¼‹æ–°å¢å·¥å…·</button>
              <button class="btn px-4 py-2 rounded-2xl text-sm" onclick="TOOLS.seed()">ä¸€éµåŠ å…¥å¸¸ç”¨é è¨­</button>
            </div>
          </div>

          <div class="grid md:grid-cols-3 gap-3">
            <div class="md:col-span-2">
              <input id="toolSearch" class="inp" placeholder="æœå°‹å·¥å…·åç¨± / åˆ†é¡ / URL..." />
            </div>
            <div>
              <select id="toolGroup" class="inp">
                <option value="">å…¨éƒ¨åˆ†é¡</option>
              </select>
            </div>
          </div>

          <div id="toolGrid" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-3"></div>
          <div class="small">æç¤ºï¼šå·¥å…· URL å¯ä»¥æ˜¯ç›¸å°è·¯å¾‘ï¼ˆä¾‹å¦‚ <span class="kbd">../questionnaire/index.html</span>ï¼‰æˆ–å®Œæ•´ç¶²å€ã€‚</div>
        </section>

        <!-- SURVEY -->
        <section id="view-survey" class="hidden glass2 rounded-3xl p-5 space-y-4">
          <div class="flex items-start justify-between gap-3 flex-wrap">
            <div>
              <div class="text-base md:text-lg font-extrabold text-slate-900">å•å·è¦å‰‡ï¼ˆRulesï¼‰</div>
              <div class="small">å°é½Š Workerï¼š<span class="kbd">/survey/rules/get</span> / <span class="kbd">/survey/rules/set</span></div>
            </div>
            <div class="flex gap-2 flex-wrap">
              <button class="btn btnP px-4 py-2 rounded-2xl text-sm font-extrabold" onclick="API.rulesGet()">è®€è¦å‰‡</button>
              <button class="btn px-4 py-2 rounded-2xl text-sm font-extrabold" onclick="API.rulesSet()">å¯«è¦å‰‡</button>
            </div>
          </div>

          <div class="grid md:grid-cols-3 gap-3">
            <div>
              <div class="text-sm font-extrabold text-slate-900">surveyKey</div>
              <div class="small">é è¨­ï¼š<span class="kbd">health_v1</span></div>
              <input id="surveyKey" class="inp mt-2" placeholder="health_v1" />
              <div class="small mt-2">KV keyï¼š<span class="kbd">SURVEY:{surveyKey}:RULES</span></div>
            </div>
            <div class="md:col-span-2 glass rounded-3xl p-4">
              <div class="text-sm font-extrabold text-slate-900">å°æé†’</div>
              <div class="small mt-1 leading-relaxed">
                ä½ ä¹‹å‰ 404 çš„åŸå› ï¼šå‰ç«¯æ‰“çš„æ˜¯ <span class="kbd">/api/q/*</span>ï¼Œä½†ä½ çš„ Worker åªæœ‰ <span class="kbd">/survey/*</span>ã€‚<br/>
                æ‰€ä»¥æˆ‘æŠŠè¶…ç´šæ§åˆ¶å°ã€Œå•å·è¦å‰‡ã€å…¨éƒ¨æ”¹æˆå°é½Šä½ ç¾åœ¨çš„ Worker è·¯ç”±ã€‚
              </div>
            </div>
          </div>

          <div>
            <div class="text-sm font-extrabold text-slate-900">rules JSON</div>
            <div class="small">è®€è¦å‰‡æœƒè‡ªå‹•å¡«å…¥ï¼›æ”¹å®ŒæŒ‰ã€Œå¯«è¦å‰‡ã€å­˜å› KVã€‚</div>
            <textarea id="rules" rows="18" class="inp mt-2 font-mono text-xs" placeholder='{"dimensions":{...},"tips":{...},"nutrients":{...},"products":{...}}'></textarea>
          </div>
        </section>

        <!-- REPORT -->
        <section id="view-report" class="hidden glass2 rounded-3xl p-5 space-y-4">
          <div class="flex items-start justify-between gap-3 flex-wrap">
            <div>
              <div class="text-base md:text-lg font-extrabold text-slate-900">ç”¢å ±å‘Šæ¸¬è©¦</div>
              <div class="small">å°é½Š Workerï¼š<span class="kbd">POST /survey/submit</span></div>
            </div>
            <div class="flex gap-2 flex-wrap">
              <button class="btn btnP px-4 py-2 rounded-2xl text-sm font-extrabold" onclick="API.submit()">é€å‡ºæ¸¬è©¦</button>
              <button class="btn px-4 py-2 rounded-2xl text-sm" onclick="API.fillDemo()">å¡«å…¥ç¯„ä¾‹</button>
            </div>
          </div>

          <div class="grid md:grid-cols-2 gap-4">
            <div>
              <div class="text-sm font-extrabold text-slate-900">answers JSON</div>
              <div class="small">ä¾‹å¦‚ï¼š<span class="kbd">{"q1":"0","q2":"2"}</span></div>
              <textarea id="answers" rows="12" class="inp mt-2 font-mono text-xs" placeholder='{"q1":"0","q2":"2"}'></textarea>
              <div class="small mt-2">å¦‚æœå›ï¼š<span class="kbd">No rules found</span> â†’ å…ˆå»ã€Œå•å·è¦å‰‡ã€å¯«å…¥ rulesã€‚</div>
            </div>

            <div class="glass rounded-3xl p-4">
              <div class="text-sm font-extrabold text-slate-900">å¿«é€Ÿæª¢æŸ¥</div>
              <div class="small mt-2 leading-relaxed">
                1) å…ˆæŒ‰ã€Œæ¸¬è©¦é€£ç·šã€æ‡‰è©²è¦å› <span class="kbd">{ ok:true, service:"survey-engine" }</span><br/>
                2) å†æŒ‰ã€Œè®€è¦å‰‡ã€ç¢ºèª KV æœ‰ rules<br/>
                3) æœ€å¾Œåœ¨é€™è£¡é€ answers ç”¢ report
              </div>
              <div class="divider my-3"></div>
              <div class="text-sm font-extrabold text-slate-900">report æœƒå‡ºç¾åœ¨ Log</div>
              <div class="small mt-1">ä½ å¯ä»¥æŠŠ Log è¤‡è£½å»æ‰¾ bugï¼Œæˆ–è²¼çµ¦æˆ‘æˆ‘ç›´æ¥å¹«ä½ ä¿®ã€‚</div>
            </div>
          </div>
        </section>

        <!-- KV -->
        <section id="view-kv" class="hidden glass2 rounded-3xl p-5 space-y-4">
          <div class="flex items-start justify-between gap-3 flex-wrap">
            <div>
              <div class="text-base md:text-lg font-extrabold text-slate-900">KV ç®¡ç†ï¼ˆçµ±ä¸€çª—å£ï¼‰</div>
              <div class="small">é€™ä¸€å€èµ° <span class="kbd">/api/kv/get</span>ã€<span class="kbd">/api/kv/put</span>ã€<span class="kbd">/api/kv/del</span>ã€<span class="kbd">/api/kv/list</span></div>
            </div>
            <div class="flex gap-2 flex-wrap">
              <button class="btn px-4 py-2 rounded-2xl text-sm" onclick="API.kvList()">åˆ—å‡º Keys</button>
              <button class="btn px-4 py-2 rounded-2xl text-sm" onclick="API.kvGet()">è®€å–</button>
              <button class="btn btnP px-4 py-2 rounded-2xl text-sm font-extrabold" onclick="API.kvPut()">å¯«å…¥</button>
              <button class="btn px-4 py-2 rounded-2xl text-sm" onclick="API.kvDel()">åˆªé™¤</button>
            </div>
          </div>

          <div class="grid md:grid-cols-12 gap-3">
            <div class="md:col-span-5">
              <div class="text-sm font-extrabold text-slate-900">Key</div>
              <input id="kvKey" class="inp mt-2" placeholder="ä¾‹å¦‚ï¼šRULES_JSON / CONFIG / TOKEN..." />
              <div class="small mt-2">Prefixï¼ˆåˆ—å‡ºç”¨ï¼Œå¯ç©ºï¼‰</div>
              <input id="kvPrefix" class="inp mt-2" placeholder="ä¾‹å¦‚ï¼šSURVEY: æˆ– ç•™ç©ºåˆ—å…¨éƒ¨" />
            </div>
            <div class="md:col-span-7">
              <div class="text-sm font-extrabold text-slate-900">Valueï¼ˆJSON / æ–‡å­—ï¼‰</div>
              <textarea id="kvVal" rows="10" class="inp mt-2 font-mono text-xs" placeholder='ä¾‹å¦‚ï¼š{"a":1} æˆ–ä»»ä½•æ–‡å­—'></textarea>
              <div class="small mt-2">
                è‹¥ä½  Worker é‚„æ²’åš /api/kv/*ï¼Œé€™é‚Šæœƒ 404ï¼ˆLog æœƒæ˜ç¢ºé¡¯ç¤ºè·¯ç”±ä¸å­˜åœ¨ï¼‰ã€‚
              </div>
            </div>
          </div>
        </section>

        <!-- SETTINGS -->
        <section id="view-settings" class="hidden glass2 rounded-3xl p-5 space-y-4">
          <div class="flex items-start justify-between gap-3 flex-wrap">
            <div>
              <div class="text-base md:text-lg font-extrabold text-slate-900">è¨­å®š / åŒ¯å…¥åŒ¯å‡º</div>
              <div class="small">ä½ å·¥å…·ä½ç½®ä¸å›ºå®š â†’ ç”¨ã€ŒåŒ¯å…¥åŒ¯å‡ºã€æœ€ç©©ï¼šæ›é›»è…¦ä¹Ÿèƒ½ä¸€éµæ¢å¾©ã€‚</div>
            </div>
            <div class="flex gap-2 flex-wrap">
              <button class="btn px-4 py-2 rounded-2xl text-sm" onclick="CFG.export()">åŒ¯å‡ºè¨­å®š</button>
              <button class="btn btnP px-4 py-2 rounded-2xl text-sm font-extrabold" onclick="CFG.import()">åŒ¯å…¥è¨­å®š</button>
              <button class="btn px-4 py-2 rounded-2xl text-sm" onclick="CFG.hardReset()">å…¨éƒ¨æ¸…ç©ºé‡ç½®</button>
            </div>
          </div>

          <div class="glass rounded-3xl p-4 space-y-2">
            <div class="text-sm font-extrabold text-slate-900">åŒ¯å…¥/åŒ¯å‡º JSON</div>
            <div class="small">é€™è£¡æœƒåŒ…å«ï¼šWorker Baseã€ADMIN_KEYã€å·¥å…·æ¸…å–®ã€‚</div>
            <textarea id="cfgJson" rows="12" class="inp font-mono text-xs" placeholder="æŒ‰ã€åŒ¯å‡ºè¨­å®šã€æœƒå‡ºç¾åœ¨é€™è£¡ï¼›æˆ–æŠŠ JSON è²¼ä¸Šå¾ŒæŒ‰ã€åŒ¯å…¥è¨­å®šã€ã€‚"></textarea>
          </div>
        </section>

        <!-- LOG -->
        <section id="view-log" class="hidden glass2 rounded-3xl p-5 space-y-3">
          <div class="flex items-center justify-between gap-3 flex-wrap">
            <div>
              <div class="text-base md:text-lg font-extrabold text-slate-900">æ—¥èªŒï¼ˆLogï¼‰</div>
              <div class="small">æ‰€æœ‰æŒ‰éˆ•éƒ½æœƒæŠŠçµæœå¯«åœ¨é€™è£¡ï¼›æŒ‰äº†æ²’åæ‡‰ = çœ‹ Log ä¸€ç§’å®šä½åŸå› ã€‚</div>
            </div>
            <div class="flex gap-2">
              <button class="btn px-4 py-2 rounded-2xl text-sm" onclick="LOG.copy()">è¤‡è£½ Log</button>
              <button class="btn px-4 py-2 rounded-2xl text-sm" onclick="LOG.clear()">æ¸…ç©º</button>
            </div>
          </div>

          <pre id="log" class="text-xs bg-white/70 border rounded-2xl p-4 overflow-auto max-h-[520px]" style="border-color:var(--bd)"></pre>
        </section>

      </main>
    </div>
  </div>

  <!-- Help Modal (ä¸æœƒå¡ä½ï¼šå¯æ²å‹•) -->
  <div id="helpModal" class="hidden fixed inset-0 z-50 items-center justify-center p-4">
    <div class="absolute inset-0 modal-back"></div>
    <div class="relative glass rounded-3xl w-full max-w-3xl p-5">
      <div class="flex items-start justify-between gap-3">
        <div>
          <div class="text-lg font-extrabold text-slate-900">æ•™å­¸ï½œé€™ä¸€é å°±æ˜¯ä½ çš„ã€Œçµ±ä¸€çª—å£ã€</div>
          <div class="small mt-1">ä½ ä¸éœ€è¦å¾ˆå¤š HTMLï¼šä¸€å€‹æ§åˆ¶å°å°±å¤ äº†ï¼ˆç”¨åˆ†é åˆ‡æ›ï¼‰ã€‚</div>
        </div>
        <button class="btn px-4 py-2 rounded-2xl text-sm" onclick="UI.closeHelp()">é—œé–‰</button>
      </div>

      <div class="mt-4 max-h-[70vh] overflow-auto pr-1 space-y-3 text-sm text-slate-700 leading-relaxed">
        <div class="glass2 rounded-2xl p-4">
          <div class="font-extrabold text-slate-900">1) å…ˆè¨­å®š Worker Base</div>
          <div class="mt-1">å·¦å´è¼¸å…¥ï¼š<span class="kbd">https://api.zxcv8096.workers.dev</span> â†’ æŒ‰ã€Œä¿å­˜ã€â†’ å†æŒ‰ã€Œæ¸¬è©¦é€£ç·šã€ã€‚</div>
        </div>

        <div class="glass2 rounded-2xl p-4">
          <div class="font-extrabold text-slate-900">2) å•å·è¦å‰‡</div>
          <div class="mt-1">å»ã€Œå•å·è¦å‰‡ã€â†’ æŒ‰ã€Œè®€è¦å‰‡ã€æ‹‰ KV â†’ ä¿®æ”¹ JSON â†’ æŒ‰ã€Œå¯«è¦å‰‡ã€ã€‚</div>
          <div class="small mt-2">å¯«è¦å‰‡éœ€è¦ ADMIN_KEYï¼ˆå¦‚æœä½  Worker æœ‰è¨­ ADMIN_KEYï¼‰ã€‚</div>
        </div>

        <div class="glass2 rounded-2xl p-4">
          <div class="font-extrabold text-slate-900">3) æ¸¬è©¦ç”¢å ±å‘Š</div>
          <div class="mt-1">å»ã€Œç”¢å ±å‘Šæ¸¬è©¦ã€è²¼ answers JSON â†’ æŒ‰ã€Œé€å‡ºæ¸¬è©¦ã€â†’ report æœƒåœ¨ Logã€‚</div>
        </div>

        <div class="glass2 rounded-2xl p-4">
          <div class="font-extrabold text-slate-900">4) å·¥å…·é€£çµï¼ˆä½ å·¥å…·æ”¾å“ªéƒ½è¡Œï¼‰</div>
          <div class="mt-1">å»ã€Œå·¥å…·é€£çµã€â†’ æ–°å¢å·¥å…· â†’ å¡«åç¨±/åˆ†é¡/URL â†’ ä¹‹å¾Œé»å¡ç‰‡å°±é–‹å•Ÿå·¥å…·ã€‚</div>
        </div>

        <div class="glass2 rounded-2xl p-4">
          <div class="font-extrabold text-slate-900">5) KV ç®¡ç†</div>
          <div class="mt-1">KV å€æœƒæ‰“ <span class="kbd">/api/kv/*</span>ï¼Œå¦‚æœä½  Worker é‚„æ²’åšé€™çµ„è·¯ç”±ï¼Œæœƒ 404ï¼ˆLog æœƒé¡¯ç¤ºè¦è£œå“ªäº›è·¯ç”±ï¼‰ã€‚</div>
        </div>

        <div class="small text-slate-500">
          ä½ å¦‚æœè¦æˆ‘æŠŠ Worker ä¹Ÿã€Œå‡ç´šæˆå®Œæ•´è¶…ç´šå¾Œç«¯ï¼ˆå« /api/kv/*ï¼‰ã€æˆ‘å¯ä»¥ç›´æ¥çµ¦ä½  worker.js è¦†è“‹ç‰ˆï¼Œä¸€æ¬¡åšåˆ°åº•ã€‚
        </div>
      </div>
    </div>
  </div>

<script>
/* ========= Storage Keys ========= */
const LS = {
  BASE: "CF_SUPER_BASE",
  ADMIN: "CF_SUPER_ADMIN",
  SURVEY_KEY: "CF_SUPER_SURVEY_KEY",
  TOOLS: "CF_SUPER_TOOLS"
};

/* ========= Log ========= */
const LOG = (() => {
  const el = ()=>document.getElementById("log");
  function ts(){ return new Date().toLocaleTimeString(); }
  function line(msg){
    const e = el();
    e.textContent = `[${ts()}] ${msg}\n` + e.textContent;
  }
  function clear(){ el().textContent = ""; }
  async function copy(){
    const t = el().textContent || "";
    try{ await navigator.clipboard.writeText(t); alert("å·²è¤‡è£½ Log"); }
    catch{ prompt("è«‹æ‰‹å‹•è¤‡è£½ï¼š", t); }
  }
  return { line, clear, copy };
})();

/* ========= Config ========= */
const CFG = (() => {
  const $ = (id)=>document.getElementById(id);
  const DEFAULT_BASE = "https://api.zxcv8096.workers.dev";
  const DEFAULT_SURVEY_KEY = "health_v1";

  function normBase(v){
    const s = String(v||"").trim();
    if(!s) return "";
    if(!/^https?:\/\//i.test(s)) return ("https://" + s.replace(/^\/+/,"")).replace(/\/+$/,"");
    return s.replace(/\/+$/,"");
  }

  function getBase(){ return normBase(localStorage.getItem(LS.BASE)) || DEFAULT_BASE; }
  function getAdmin(){ return (localStorage.getItem(LS.ADMIN) || "").trim(); }
  function getSurveyKey(){ return (localStorage.getItem(LS.SURVEY_KEY) || DEFAULT_SURVEY_KEY).trim() || DEFAULT_SURVEY_KEY; }

  function loadToUI(){
    $("base").value = getBase();
    $("adminKey").value = getAdmin();
    $("surveyKey").value = getSurveyKey();
    UI.refreshOverview();
  }

  function save(){
    const b = normBase($("base").value) || DEFAULT_BASE;
    localStorage.setItem(LS.BASE, b);
    localStorage.setItem(LS.ADMIN, ($("adminKey").value||"").trim());
    localStorage.setItem(LS.SURVEY_KEY, ($("surveyKey").value||"").trim() || DEFAULT_SURVEY_KEY);
    $("base").value = b;
    UI.setPill("å·²ä¿å­˜ âœ…");
    LOG.line(`âœ… ä¿å­˜è¨­å®šï¼šbase=${b} / surveyKey=${getSurveyKey()}`);
    UI.refreshOverview();
    TOOLS.render();
  }

  function hardReset(){
    if(!confirm("ç¢ºå®šè¦æ¸…ç©ºå…¨éƒ¨è¨­å®šï¼Ÿï¼ˆBase / Key / å·¥å…·æ¸…å–® éƒ½æœƒæ¸…æ‰ï¼‰")) return;
    localStorage.removeItem(LS.BASE);
    localStorage.removeItem(LS.ADMIN);
    localStorage.removeItem(LS.SURVEY_KEY);
    localStorage.removeItem(LS.TOOLS);
    loadToUI();
    TOOLS.render();
    LOG.line("ğŸ” å·²å…¨éƒ¨æ¸…ç©ºé‡ç½®");
  }

  function exportCfg(){
    const obj = {
      base: getBase(),
      adminKey: getAdmin(),
      surveyKey: getSurveyKey(),
      tools: TOOLS.getAll()
    };
    document.getElementById("cfgJson").value = JSON.stringify(obj, null, 2);
    UI.setPill("å·²åŒ¯å‡º âœ…");
    LOG.line("ğŸ“¦ å·²åŒ¯å‡ºè¨­å®šï¼ˆJSON å·²æ”¾åˆ°è¼¸å…¥æ¡†ï¼‰");
  }

  function importCfg(){
    const raw = (document.getElementById("cfgJson").value || "").trim();
    if(!raw) return alert("è«‹å…ˆè²¼ä¸Š JSON");
    let obj = null;
    try{ obj = JSON.parse(raw); }catch{ return alert("JSON æ ¼å¼éŒ¯èª¤"); }

    if(obj.base) localStorage.setItem(LS.BASE, normBase(obj.base));
    if(typeof obj.adminKey === "string") localStorage.setItem(LS.ADMIN, obj.adminKey.trim());
    if(obj.surveyKey) localStorage.setItem(LS.SURVEY_KEY, String(obj.surveyKey).trim());
    if(Array.isArray(obj.tools)) localStorage.setItem(LS.TOOLS, JSON.stringify(obj.tools));

    loadToUI();
    TOOLS.render();
    UI.setPill("å·²åŒ¯å…¥ âœ…");
    LOG.line("âœ… å·²åŒ¯å…¥è¨­å®šï¼ˆåŒ…å«å·¥å…·æ¸…å–®ï¼‰");
  }

  return {
    getBase, getAdmin, getSurveyKey,
    loadToUI, save,
    hardReset,
    export: exportCfg,
    import: importCfg
  };
})();

/* ========= API ========= */
const API = (() => {
  function headers(withAdmin=false){
    const h = { "Content-Type":"application/json" };
    if(withAdmin){
      const k = CFG.getAdmin();
      if(k) h["X-Admin-Key"] = k;
    }
    return h;
  }

  async function request(method, path, body=null, withAdmin=false){
    const base = CFG.getBase();
    const url = base + path;
    LOG.line(`â¡ï¸ ${method} ${url}`);
    try{
      const res = await fetch(url, {
        method,
        mode: "cors",
        headers: headers(withAdmin),
        body: body ? JSON.stringify(body) : undefined
      });
      const text = await res.text();
      LOG.line(`â¬…ï¸ HTTP ${res.status} ${res.ok ? "OK" : "ERR"}`);

      let json = null;
      try{ json = JSON.parse(text); }
      catch{ json = { ok:false, raw:text }; }

      LOG.line(`ğŸ“¦ ${JSON.stringify(json, null, 2)}`);
      return { ok: res.ok, status: res.status, data: json };
    }catch(e){
      LOG.line(`âŒ Fetch å¤±æ•—ï¼š${e?.message || e}`);
      LOG.line(`âš ï¸ å¸¸è¦‹åŸå› ï¼šCORS / ç¶²åŸŸæ‰“éŒ¯ / Worker æ²’éƒ¨ç½²åˆ°é€™å€‹ domain`);
      return { ok:false, status:0, data:null };
    }
  }

  async function ping(){
    UI.setPill("æ¸¬è©¦ä¸­â€¦");
    const r = await request("GET", "/health");
    UI.setPill(r.ok ? "é€£ç·š OK âœ…" : `é€£ç·šå¤±æ•— (${r.status})`);
  }

  async function rulesGet(){
    const surveyKey = CFG.getSurveyKey();
    UI.setPill("è®€è¦å‰‡ä¸­â€¦");
    const r = await request("POST", "/survey/rules/get", { surveyKey });
    if(r.ok && r.data){
      document.getElementById("rules").value = r.data.rules ? JSON.stringify(r.data.rules, null, 2) : "";
      UI.setPill("è®€è¦å‰‡å®Œæˆ âœ…");
      if(!r.data.rules) LOG.line("âš ï¸ rules=nullï¼šKV å°šæœªå­˜è¦å‰‡ï¼Œè«‹è²¼ä¸Š rules å¾ŒæŒ‰ã€å¯«è¦å‰‡ã€");
    }else{
      UI.setPill(`è®€è¦å‰‡å¤±æ•— (${r.status})`);
    }
  }

  async function rulesSet(){
    const surveyKey = CFG.getSurveyKey();
    const raw = (document.getElementById("rules").value || "").trim();
    if(!raw) return alert("rules ä¸èƒ½ç©ºç™½");
    let rulesObj = null;
    try{ rulesObj = JSON.parse(raw); }catch{ return alert("rules ä¸æ˜¯åˆæ³• JSON"); }

    UI.setPill("å¯«è¦å‰‡ä¸­â€¦");
    const r = await request("POST", "/survey/rules/set", { surveyKey, rules: rulesObj }, true);
    UI.setPill(r.ok ? "å¯«å…¥å®Œæˆ âœ…" : `å¯«å…¥å¤±æ•— (${r.status})`);
    if(!CFG.getAdmin() && r.status === 401){
      LOG.line("âš ï¸ ä½  Worker æœ‰è¨­ ADMIN_KEYï¼Œä½†å‰ç«¯æ²’å¡« ADMIN_KEYï¼Œæ‰€ä»¥è¢« 401ã€‚");
    }
  }

  async function submit(){
    const surveyKey = CFG.getSurveyKey();
    const raw = (document.getElementById("answers").value || "").trim();
    let answers = {};
    if(raw){
      try{ answers = JSON.parse(raw); }catch{ return alert("answers ä¸æ˜¯åˆæ³• JSON"); }
    }
    UI.setPill("ç”¢å ±å‘Šä¸­â€¦");
    const r = await request("POST", "/survey/submit", { surveyKey, answers });
    UI.setPill(r.ok ? "å·²ç”¢å‡º report âœ…" : `ç”¢å ±å‘Šå¤±æ•— (${r.status})`);
  }

  function fillDemo(){
    document.getElementById("answers").value = JSON.stringify({ q1:"0", q2:"2", q3:"1" }, null, 2);
    LOG.line("ğŸ§ª å·²å¡«å…¥ answers ç¯„ä¾‹");
  }

  // KV (expects worker to have /api/kv/*)
  async function kvGet(){
    const key = (document.getElementById("kvKey").value || "").trim();
    if(!key) return alert("Key ä¸èƒ½ç©ºç™½");
    UI.setPill("KV è®€å–ä¸­â€¦");
    const r = await request("POST", "/api/kv/get", { key });
    UI.setPill(r.ok ? "KV è®€å–å®Œæˆ âœ…" : `KV è®€å–å¤±æ•— (${r.status})`);
  }
  async function kvPut(){
    const key = (document.getElementById("kvKey").value || "").trim();
    if(!key) return alert("Key ä¸èƒ½ç©ºç™½");
    const raw = document.getElementById("kvVal").value;
    let value = raw;
    try{ value = JSON.parse(raw); }catch{}
    UI.setPill("KV å¯«å…¥ä¸­â€¦");
    const r = await request("POST", "/api/kv/put", { key, value }, true);
    UI.setPill(r.ok ? "KV å¯«å…¥å®Œæˆ âœ…" : `KV å¯«å…¥å¤±æ•— (${r.status})`);
  }
  async function kvDel(){
    const key = (document.getElementById("kvKey").value || "").trim();
    if(!key) return alert("Key ä¸èƒ½ç©ºç™½");
    UI.setPill("KV åˆªé™¤ä¸­â€¦");
    const r = await request("POST", "/api/kv/del", { key }, true);
    UI.setPill(r.ok ? "KV åˆªé™¤å®Œæˆ âœ…" : `KV åˆªé™¤å¤±æ•— (${r.status})`);
  }
  async function kvList(){
    const prefix = (document.getElementById("kvPrefix").value || "").trim();
    UI.setPill("KV åˆ—è¡¨ä¸­â€¦");
    const r = await request("POST", "/api/kv/list", { prefix });
    UI.setPill(r.ok ? "KV åˆ—è¡¨å®Œæˆ âœ…" : `KV åˆ—è¡¨å¤±æ•— (${r.status})`);
  }

  return { ping, rulesGet, rulesSet, submit, fillDemo, kvGet, kvPut, kvDel, kvList };
})();

/* ========= Tools Manager ========= */
const TOOLS = (() => {
  const $ = (id)=>document.getElementById(id);

  function getAll(){
    const raw = localStorage.getItem(LS.TOOLS);
    if(!raw) return [];
    try{
      const arr = JSON.parse(raw);
      return Array.isArray(arr) ? arr : [];
    }catch{ return []; }
  }
  function setAll(arr){
    localStorage.setItem(LS.TOOLS, JSON.stringify(arr || []));
    UI.refreshOverview();
  }

  function uniqueId(){
    return "t_" + Math.random().toString(36).slice(2, 10);
  }

  function resolveUrl(url){
    const u = String(url||"").trim();
    if(!u) return "";
    // absolute
    if(/^https?:\/\//i.test(u)) return u;
    // relative -> resolve from current page
    try{ return new URL(u, location.href).toString(); }
    catch{ return u; }
  }

  function groups(){
    const arr = getAll();
    const set = new Set();
    arr.forEach(t=> set.add((t.group||"").trim() || "æœªåˆ†é¡"));
    return Array.from(set).sort((a,b)=>a.localeCompare(b,"zh-Hant"));
  }

  function renderGroups(){
    const sel = $("toolGroup");
    const cur = sel.value;
    sel.innerHTML = `<option value="">å…¨éƒ¨åˆ†é¡</option>`;
    groups().forEach(g=>{
      const op = document.createElement("option");
      op.value = g;
      op.textContent = g;
      sel.appendChild(op);
    });
    if([...sel.options].some(o=>o.value===cur)) sel.value = cur;
  }

  function render(){
    renderGroups();
    const grid = $("toolGrid");
    const q = ($("toolSearch").value||"").trim().toLowerCase();
    const g = ($("toolGroup").value||"").trim();

    const arr = getAll().filter(t=>{
      const gg = (t.group||"æœªåˆ†é¡").trim() || "æœªåˆ†é¡";
      if(g && gg !== g) return false;
      const hay = `${t.name||""} ${gg} ${t.url||""}`.toLowerCase();
      return !q || hay.includes(q);
    });

    grid.innerHTML = "";
    if(!arr.length){
      grid.innerHTML = `<div class="small text-slate-600">å°šç„¡å·¥å…·ã€‚æŒ‰ã€Œï¼‹æ–°å¢å·¥å…·ã€æˆ–ã€Œä¸€éµåŠ å…¥å¸¸ç”¨é è¨­ã€ã€‚</div>`;
      return;
    }

    arr.forEach(t=>{
      const card = document.createElement("div");
      card.className = "glass rounded-3xl p-4 flex flex-col gap-3";
      const gg = (t.group||"æœªåˆ†é¡").trim() || "æœªåˆ†é¡";
      const url = resolveUrl(t.url);

      card.innerHTML = `
        <div class="flex items-start justify-between gap-2">
          <div class="min-w-0">
            <div class="font-extrabold text-slate-900 truncate">${escapeHtml(t.name||"æœªå‘½åå·¥å…·")}</div>
            <div class="small truncate">${escapeHtml(gg)}</div>
          </div>
          <span class="pill">${escapeHtml(t.kind || "é é¢")}</span>
        </div>
        <div class="text-xs text-slate-700 break-words">${escapeHtml(url)}</div>
        <div class="flex gap-2 mt-1">
          <button class="btn btnP px-3 py-2 rounded-2xl text-sm font-extrabold w-full" data-act="open">é–‹å•Ÿ</button>
          <button class="btn px-3 py-2 rounded-2xl text-sm w-full" data-act="edit">ç·¨è¼¯</button>
          <button class="btn px-3 py-2 rounded-2xl text-sm w-full" data-act="del">åˆªé™¤</button>
        </div>
      `;

      card.querySelector('[data-act="open"]').onclick = ()=>{
        if(!url) return;
        window.open(url, "_blank", "noopener,noreferrer");
      };
      card.querySelector('[data-act="edit"]').onclick = ()=>openEdit(t.id);
      card.querySelector('[data-act="del"]').onclick = ()=>{
        if(!confirm(`åˆªé™¤ã€Œ${t.name}ã€ï¼Ÿ`)) return;
        setAll(getAll().filter(x=>x.id!==t.id));
        render();
        LOG.line(`ğŸ—‘ å·²åˆªé™¤å·¥å…·ï¼š${t.name}`);
      };

      grid.appendChild(card);
    });
  }

  function openAdd(){
    const name = prompt("å·¥å…·åç¨±ï¼ˆä¸­æ–‡ï¼‰ï¼Ÿ", "æ–°å·¥å…·");
    if(name===null) return;
    const group = prompt("åˆ†é¡ï¼ˆå¯ç©ºï¼‰ï¼Ÿ", "å·¥å…·") ?? "";
    const url = prompt("å·¥å…· URLï¼ˆå¯ç›¸å°è·¯å¾‘æˆ–å®Œæ•´ç¶²å€ï¼‰ï¼Ÿ", "") ?? "";
    const kind = prompt("é¡å‹ï¼ˆä¾‹å¦‚ï¼šå¾Œå°/å·¥å…·/é é¢ï¼‰ï¼Ÿ", "é é¢") ?? "é é¢";

    const arr = getAll();
    arr.unshift({ id: uniqueId(), name: name.trim()||"æ–°å·¥å…·", group: group.trim()||"æœªåˆ†é¡", url: url.trim(), kind: kind.trim()||"é é¢" });
    setAll(arr);
    render();
    LOG.line(`â• å·²æ–°å¢å·¥å…·ï¼š${name}`);
  }

  function openEdit(id){
    const t = getAll().find(x=>x.id===id);
    if(!t) return;

    const name = prompt("å·¥å…·åç¨±ï¼ˆä¸­æ–‡ï¼‰", t.name || "") ;
    if(name===null) return;
    const group = prompt("åˆ†é¡ï¼ˆå¯ç©ºï¼‰", t.group || "") ;
    if(group===null) return;
    const url = prompt("å·¥å…· URLï¼ˆå¯ç›¸å°æˆ–å®Œæ•´ï¼‰", t.url || "") ;
    if(url===null) return;
    const kind = prompt("é¡å‹ï¼ˆä¾‹å¦‚ï¼šå¾Œå°/å·¥å…·/é é¢ï¼‰", t.kind || "é é¢") ;
    if(kind===null) return;

    const arr = getAll().map(x=>{
      if(x.id!==id) return x;
      return { ...x, name:name.trim(), group:group.trim()||"æœªåˆ†é¡", url:url.trim(), kind:kind.trim()||"é é¢" };
    });
    setAll(arr);
    render();
    LOG.line(`âœï¸ å·²æ›´æ–°å·¥å…·ï¼š${name}`);
  }

  function seed(){
    const arr = getAll();
    const exists = (u)=>arr.some(x=>(x.url||"").trim()===u.trim());
    const add = (name, group, url, kind="é é¢")=>{
      if(exists(url)) return;
      arr.push({ id: uniqueId(), name, group, url, kind });
    };

    // âœ… ä½ ç›®å‰æœ‰æåˆ°çš„å•å·ä½ç½®ï¼ˆå¯æ”¹ã€ä¹Ÿå¯åˆªï¼‰
    add("å•å·ï¼ˆå‰å°ï¼‰", "å•å·", "https://zxcv8096-dotcom.github.io/line-tool/pages/questionnaire/index.html", "é é¢");

    // âœ… ä½  repo tools å¸¸è¦‹æª”åï¼ˆä¸ç¶æ­»è·¯å¾‘ï¼šåªæ˜¯çµ¦ä½ ä¸€éµé è¨­ï¼‰
    add("å·¥å…·ï½œè‡ªå‹•å›è¦†", "å·¥å…·", "../tools/auto_reply.html");
    add("å·¥å…·ï½œå¯¦é©—å®¤å„€è¡¨æ¿", "å·¥å…·", "../tools/lab_dashboard.html");
    add("å·¥å…·ï½œå¿«é€Ÿå›è¦†", "å·¥å…·", "../tools/quickreply.html");
    add("å·¥å…·ï½œè¼ªæ’­ç”¢ç”Ÿå™¨", "å·¥å…·", "../tools/tool_carousel.html");
    add("å·¥å…·ï½œæµç¨‹ç·¨æ’", "å·¥å…·", "../tools/tool_flow.html");
    add("å·¥å…·ï½œåœ–ç‰‡ç†±é»", "å·¥å…·", "../tools/tool_imagemap.html");
    add("å·¥å…·ï½œMeta ç·¨è¼¯å™¨", "å·¥å…·", "../tools/tool_meta_editor.html");
    add("å·¥å…·ï½œRichMenu", "å·¥å…·", "../tools/tool_richmenu.html");

    setAll(arr);
    render();
    LOG.line("âœ¨ å·²åŠ å…¥å¸¸ç”¨é è¨­å·¥å…·ï¼ˆå¯è‡ªè¡Œç·¨è¼¯ URLï¼‰");
    UI.setPill("å·²åŠ å…¥é è¨­ âœ…");
  }

  function escapeHtml(s){
    return String(s ?? "")
      .replaceAll("&","&amp;")
      .replaceAll("<","&lt;")
      .replaceAll(">","&gt;")
      .replaceAll('"',"&quot;")
      .replaceAll("'","&#039;");
  }

  return { getAll, setAll, render, openAdd, seed };
})();

/* ========= UI ========= */
const UI = (() => {
  const tabs = ()=>Array.from(document.querySelectorAll(".tab"));
  const views = ()=>Array.from(document.querySelectorAll("main section[id^='view-']"));
  const map = {
    overview: "view-overview",
    tools: "view-tools",
    survey: "view-survey",
    report: "view-report",
    kv: "view-kv",
    settings: "view-settings",
    log: "view-log"
  };

  function setPill(text){
    document.getElementById("pillStatus").textContent = text || "â€”";
    clearTimeout(setPill._t);
    setPill._t = setTimeout(()=>{ document.getElementById("pillStatus").textContent = "â€”"; }, 2400);
  }

  function go(name){
    tabs().forEach(t=>t.classList.toggle("active", t.dataset.tab===name));
    views().forEach(v=>v.classList.add("hidden"));
    const id = map[name] || map.overview;
    document.getElementById(id).classList.remove("hidden");

    // small convenience
    if(name==="tools") TOOLS.render();
    if(name==="overview") refreshOverview();
  }

  function openHelp(){
    const m = document.getElementById("helpModal");
    m.classList.remove("hidden");
    m.classList.add("flex");
  }
  function closeHelp(){
    const m = document.getElementById("helpModal");
    m.classList.add("hidden");
    m.classList.remove("flex");
  }

  function refreshOverview(){
    document.getElementById("ovBase").textContent = CFG.getBase();
    document.getElementById("ovTools").textContent = String(TOOLS.getAll().length || 0);
  }

  function wire(){
    tabs().forEach(btn=>{
      btn.addEventListener("click", ()=>go(btn.dataset.tab));
    });

    // tool filters
    document.getElementById("toolSearch").addEventListener("input", ()=>TOOLS.render());
    document.getElementById("toolGroup").addEventListener("change", ()=>TOOLS.render());

    // close modal by background click
    document.getElementById("helpModal").addEventListener("click", (e)=>{
      if(e.target === document.getElementById("helpModal")) closeHelp();
    });
  }

  return { go, openHelp, closeHelp, setPill, refreshOverview, wire };
})();

/* ========= Boot ========= */
(function boot(){
  CFG.loadToUI();
  UI.wire();
  UI.go("overview");
  TOOLS.render();
})();
</script>
</body>
</html>

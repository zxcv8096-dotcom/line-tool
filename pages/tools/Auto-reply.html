<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤§å¿ƒAI Flow | æå˜‰å“²Gavin ğŸ‘‘</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .bright-gradient { background: linear-gradient(135deg, #4f46e5 0%, #9333ea 100%); }
        .guide-step { @apply border-l-4 border-indigo-500 pl-4 py-1 mb-4; }
        .warning-item { @apply flex items-start gap-2 text-xs text-orange-800 mb-2; }
    </style>
</head>
<body class="bg-slate-50 font-sans text-slate-800 pb-20">

    <nav class="bg-white border-b border-slate-200 p-5 sticky top-0 z-50 shadow-sm">
        <div class="container mx-auto flex justify-between items-center">
            <div class="flex items-center gap-3">
                <div class="p-2 bg-indigo-600 rounded-lg text-white font-black italic text-xl shadow-lg shadow-indigo-200">å¤§å¿ƒ</div>
                <div>
                    <h1 class="text-xl font-black text-slate-900 tracking-tight">AI Flow ç³»çµ±</h1>
                    <p class="text-[10px] text-indigo-600 font-bold uppercase tracking-widest">ç³»çµ±ç›£è£½ï¼šæå˜‰å“² Gavin</p>
                </div>
            </div>
            <div class="text-right hidden sm:block">
                <p class="text-sm font-bold text-slate-900">2026 æ·¨è³‡ç”¢ 700 è¬ç›®æ¨™ ğŸ’°</p>
            </div>
        </div>
    </nav>

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">
        
        <div class="bg-orange-50 border border-orange-200 rounded-3xl p-6 mb-8 shadow-sm">
            <h3 class="text-sm font-black text-orange-900 uppercase tracking-widest mb-4 flex items-center gap-2">
                âš ï¸ ä½¿ç”¨å‰å¿…è®€ï¼šé¿å…ç³»çµ±ç„¡æ•ˆçš„é—œéµ
            </h3>
            <div class="grid md:grid-cols-3 gap-6">
                <div class="warning-item">
                    <span class="text-lg">ğŸš«</span>
                    <div>
                        <p class="font-bold">FB å€‹äººæª”æ¡ˆä¸èƒ½ç”¨</p>
                        <p class="opacity-80">è‡ªå‹•å›è¦†åƒ…æ”¯æ´ã€Œç²‰çµ²å°ˆé  (Fan Page)ã€ã€‚è«‹å‹¿ç¶å®šå€‹äººå¸³è™Ÿã€‚</p>
                    </div>
                </div>
                <div class="warning-item">
                    <span class="text-lg">ğŸ“¸</span>
                    <div>
                        <p class="font-bold">IG å¿…é ˆæ˜¯å•†æ¥­å¸³è™Ÿ</p>
                        <p class="opacity-80">è«‹è‡³ IG è¨­å®š > å¸³è™Ÿ > åˆ‡æ›ç‚ºã€Œå•†æ¥­å¸³è™Ÿã€æˆ–ã€Œå‰µä½œè€…å¸³è™Ÿã€ã€‚</p>
                    </div>
                </div>
                <div class="warning-item">
                    <span class="text-lg">ğŸ”‘</span>
                    <div>
                        <p class="font-bold">æ¬Šé™å¿…é ˆå…¨é–‹</p>
                        <p class="opacity-80">åœ¨é€£çµ Meta æ™‚ï¼Œè«‹å‹¾é¸ã€Œå…è¨±ç®¡ç†è¨Šæ¯ã€çš„æ‰€æœ‰æ¬Šé™ï¼Œå¦å‰‡æ©Ÿå™¨äººæœƒè®Šå•å·´ã€‚</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="grid lg:grid-cols-4 gap-8">
            
            <div class="lg:col-span-1 space-y-6">
                <div class="bg-white p-6 rounded-3xl shadow-sm border border-slate-200">
                    <h3 class="text-xs font-bold text-slate-400 uppercase mb-4 tracking-widest">ğŸ” èº«ä»½é‡‘é‘°</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="text-[10px] font-bold text-slate-600">å°ˆå±¬å¸³è™Ÿè­˜åˆ¥ç¢¼</label>
                            <input id="accountKey" type="password" placeholder="è¼¸å…¥ä½ çš„é‡‘é‘° (å¦‚ Gavin01)" class="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-xs mt-1 outline-none focus:ring-2 ring-indigo-500/20">
                        </div>
                        <button onclick="syncData()" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 rounded-xl text-xs transition shadow-lg active:scale-95">åŒæ­¥é›²ç«¯è³‡æ–™ ğŸ”„</button>
                    </div>
                </div>
                
                <div class="bg-indigo-900 text-white p-6 rounded-3xl shadow-xl">
                    <h3 class="font-bold text-sm mb-2">æˆ‘æ˜¯æ–°æ‰‹æ€éº¼è¾¦ï¼Ÿ</h3>
                    <p class="text-xs opacity-80 leading-relaxed">
                        åˆ¥æ“”å¿ƒï¼å…ˆæŠŠå³é‚Šçš„è¦å‰‡å¡«å¥½ï¼ŒæŒ‰ä¸‹ã€Œç”Ÿæˆä»£ç¢¼ã€ï¼Œä¸‹é¢æœƒå‡ºç¾è©³ç´°çš„æ­¥é©Ÿæ•™å­¸åœ–ï¼Œè·Ÿè‘—åšå°±èƒ½å®Œæˆéƒ¨ç½²ï¼ğŸš€
                    </p>
                </div>
            </div>

            <div class="lg:col-span-3 space-y-8">
                
                <div class="bg-white p-8 rounded-3xl shadow-xl border border-slate-200 relative overflow-hidden">
                    <div class="absolute top-0 left-0 w-2 h-full bg-indigo-600"></div>
                    <div class="flex justify-between items-center mb-8 border-b pb-4">
                        <h2 class="text-xl font-black text-slate-900 tracking-tight">æ™ºèƒ½è¦å‰‡ç·¨è¼¯å™¨</h2>
                        <span id="syncStatus" class="text-[10px] bg-slate-100 text-slate-500 px-3 py-1 rounded-full">ç­‰å¾…åŒæ­¥...</span>
                    </div>

                    <div class="grid md:grid-cols-2 gap-8">
                        <div class="space-y-6">
                            <div>
                                <label class="block text-xs font-bold text-slate-500 mb-2 uppercase">1. é¸æ“‡å¹³å°</label>
                                <div class="flex gap-2 flex-wrap">
                                    <label class="bg-slate-50 px-3 py-2 rounded-xl border text-xs cursor-pointer font-bold hover:bg-indigo-50"><input type="checkbox" name="platform" value="FB" checked> FB ç²‰å°ˆ</label>
                                    <label class="bg-slate-50 px-3 py-2 rounded-xl border text-xs cursor-pointer font-bold hover:bg-pink-50"><input type="checkbox" name="platform" value="IG" checked> IG å•†æ¥­</label>
                                    <label class="bg-slate-50 px-3 py-2 rounded-xl border text-xs cursor-pointer font-bold hover:bg-slate-200"><input type="checkbox" name="platform" value="TikTok"> TikTok</label>
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-xs font-bold text-slate-500 mb-2 uppercase">2. é—œéµå­—è¨­å®š</label>
                                <div class="flex gap-2">
                                    <input id="keyword" type="text" placeholder="ä¾‹å¦‚ï¼šé ˜å–æ–¹æ¡ˆ" class="flex-1 bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm outline-none">
                                    <select id="matchMode" class="bg-white border border-slate-200 rounded-xl px-2 py-1 text-xs outline-none">
                                        <option value="includes">åŒ…å«å³å¯ âœ¨</option>
                                        <option value="exact">å®Œå…¨ç›¸åŒ</option>
                                    </select>
                                </div>
                            </div>

                            <div class="bg-slate-50 p-5 rounded-2xl border border-slate-100">
                                <label class="block text-xs font-bold text-slate-600 mb-2">3. é™„åŠ åª’é«” (ç¾åœ–/å½±ç‰‡)</label>
                                <div class="flex gap-2 mb-3">
                                    <input id="mediaUrl" type="text" placeholder="HTTPS ç¶²å€..." class="flex-1 bg-white border border-slate-200 rounded-xl px-4 py-2 text-xs outline-none">
                                    <button onclick="addAttach()" class="bg-indigo-600 text-white px-4 rounded-xl font-bold">ï¼‹</button>
                                </div>
                                <div id="attachList" class="space-y-2"></div>
                            </div>
                        </div>

                        <div>
                            <label class="block text-xs font-bold text-slate-500 mb-2 uppercase">4. æ„Ÿæ€§å›è¦†æ–‡æ¡ˆ</label>
                            <textarea id="replyText" rows="12" placeholder="æå˜‰å“²Gavin å»ºè­°ï¼šå¤šç”¨è¡¨æƒ…ç¬¦è™Ÿ ğŸ˜Šï¼Œè®“å°è©±æ›´æœ‰æº«åº¦..." class="w-full bg-slate-50 border border-slate-200 rounded-2xl p-4 text-sm outline-none focus:bg-white transition h-[calc(100%-2rem)]"></textarea>
                        </div>
                    </div>

                    <button onclick="saveRule()" class="mt-8 w-full bright-gradient text-white font-black py-4 rounded-2xl shadow-xl hover:opacity-90 transition transform active:scale-95 text-lg">
                        å„²å­˜ä¸¦ç”Ÿæˆä»£ç¢¼ ğŸš€
                    </button>
                </div>

                <div class="grid md:grid-cols-2 gap-8">
                    
                    <div class="bg-slate-900 p-6 rounded-3xl shadow-2xl relative border-t-8 border-indigo-500 h-full">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-indigo-400 font-mono text-[10px] font-bold uppercase tracking-widest">// GAS ç³»çµ±ä»£ç¢¼</h3>
                            <button onclick="copyCode()" class="bg-indigo-600 text-white px-4 py-1 rounded-full text-[10px] font-bold hover:bg-indigo-500 transition">è¤‡è£½å…¨éƒ¨</button>
                        </div>
                        <pre id="outputCode" class="text-indigo-200 font-mono text-[9px] overflow-x-auto leading-loose h-[300px]">const REPLY_RULES = [];</pre>
                    </div>

                    <div class="bg-white p-6 rounded-3xl shadow-lg border border-slate-200 h-full">
                        <h3 class="font-black text-slate-800 mb-6 text-sm flex items-center gap-2">
                            <span class="bg-indigo-600 text-white w-5 h-5 rounded-full flex items-center justify-center text-[10px]">?</span>
                            æ‹¿åˆ°ä»£ç¢¼å¾Œï¼Œä¸‹ä¸€æ­¥åšä»€éº¼ï¼Ÿ
                        </h3>
                        
                        <div class="space-y-1">
                            <div class="guide-step">
                                <h4 class="font-bold text-xs text-indigo-700">Step 1. é€²å…¥ Google GAS</h4>
                                <p class="text-[10px] text-slate-500">æœå°‹ "Google Apps Script" ä¸¦å»ºç«‹æ–°å°ˆæ¡ˆã€‚</p>
                            </div>
                            <div class="guide-step">
                                <h4 class="font-bold text-xs text-indigo-700">Step 2. è²¼ä¸Šä»£ç¢¼</h4>
                                <p class="text-[10px] text-slate-500">æ¸…ç©ºåŸæœ¬çš„å…§å®¹ï¼Œå°‡å·¦é‚Šè¤‡è£½çš„ä»£ç¢¼ã€Œè²¼åœ¨æœ€ä¸Šæ–¹ã€ã€‚</p>
                            </div>
                            <div class="guide-step">
                                <h4 class="font-bold text-xs text-indigo-700">Step 3. å¡«å…¥ Meta æ¬Šæ–</h4>
                                <p class="text-[10px] text-slate-500">åœ¨ä»£ç¢¼ä¸­æ‰¾åˆ° `PAGE_ACCESS_TOKEN`ï¼Œå¡«å…¥ FB å¾Œå°çµ¦ä½ çš„äº‚ç¢¼ã€‚</p>
                            </div>
                            <div class="guide-step">
                                <h4 class="font-bold text-xs text-indigo-700">Step 4. éƒ¨ç½²ç‚ºç¶²é æ‡‰ç”¨ç¨‹å¼</h4>
                                <p class="text-[10px] text-slate-500">é»æ“Šå³ä¸Šè§’ã€Œéƒ¨ç½²ã€>ã€Œæ–°å¢éƒ¨ç½²ã€> æ¬Šé™é¸ã€Œæ‰€æœ‰äºº (Anyone)ã€> è¤‡è£½ç¶²å€ã€‚</p>
                            </div>
                            <div class="bg-indigo-50 p-3 rounded-xl mt-4">
                                <p class="text-[10px] font-bold text-indigo-800 text-center">ğŸ‰ æœ€å¾Œï¼šå°‡ç¶²å€è²¼å› Meta å¾Œå°çš„ Webhookï¼</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-3xl shadow-sm border border-slate-200">
                     <h3 class="font-black text-slate-800 mb-4 text-xs uppercase tracking-widest flex justify-between">
                        æˆ‘çš„å¼•æµè³‡ç”¢åº«
                        <button onclick="clearAll()" class="text-red-400 font-normal">æ¸…ç©ºé‡è¨­</button>
                    </h3>
                    <div id="ruleDisplay" class="grid md:grid-cols-2 gap-4 max-h-[200px] overflow-y-auto"></div>
                </div>

            </div>
        </div>
    </div>

    <script>
        let rules = [];
        let currentAttach = [];

        function syncData() {
            const key = document.getElementById('accountKey').value;
            if(!key) return alert('è«‹å…ˆè¼¸å…¥å¸³è™Ÿé‡‘é‘°ï¼');
            const data = localStorage.getItem('vault_' + key);
            rules = data ? JSON.parse(data) : [];
            document.getElementById('syncStatus').innerText = 'å·²é–å®š: ' + key;
            document.getElementById('syncStatus').className = 'text-[10px] bg-green-100 text-green-600 px-3 py-1 rounded-full font-bold';
            renderUI();
            alert('åŒæ­¥å®Œæˆï¼ç›®å‰è³‡ç”¢åº«æœ‰ ' + rules.length + ' æ¢è¦å‰‡ã€‚');
        }

        function addAttach() {
            const url = document.getElementById('mediaUrl').value;
            if(!url) return;
            currentAttach.push(url);
            renderAttach();
            document.getElementById('mediaUrl').value = '';
        }

        function renderAttach() {
            document.getElementById('attachList').innerHTML = currentAttach.map((url, i) => `
                <div class="bg-white p-2 rounded-xl flex justify-between items-center text-[9px] border border-slate-100 shadow-sm">
                    <span class="truncate opacity-50 flex-1">${url}</span>
                    <button onclick="currentAttach.splice(${i},1);renderAttach()" class="text-red-400 ml-2 font-bold">ç§»é™¤</button>
                </div>`).join('');
        }

        function saveRule() {
            const key = document.getElementById('accountKey').value;
            const kw = document.getElementById('keyword').value;
            const mode = document.getElementById('matchMode').value;
            const text = document.getElementById('replyText').value;
            const platforms = Array.from(document.querySelectorAll('input[name="platform"]:checked')).map(cb => cb.value);

            if(!key) return alert('è«‹è¼¸å…¥å¸³è™Ÿé‡‘é‘°ä»¥é€²è¡Œå­˜æª”ï¼');
            if(!kw || !text) return alert('å…§å®¹ä¸å®Œæ•´å–”ï¼');

            rules.push({ platforms, keyword: kw, mode: mode, text: text, attachments: [...currentAttach] });
            localStorage.setItem('vault_' + key, JSON.stringify(rules));
            renderUI();
            
            document.getElementById('keyword').value = '';
            document.getElementById('replyText').value = '';
            currentAttach = [];
            renderAttach();
        }

        function renderUI() {
            const display = document.getElementById('ruleDisplay');
            display.innerHTML = rules.length === 0 ? '<p class="text-center text-slate-400 py-6 text-xs italic col-span-2">æš«ç„¡è³‡æ–™</p>' : '';
            rules.forEach((r, i) => {
                display.innerHTML += `
                    <div class="bg-slate-50 p-4 rounded-2xl border border-slate-100 relative group hover:bg-white hover:shadow-md transition">
                        <div class="flex gap-1 mb-2">
                            ${r.platforms.map(p => `<span class="px-2 py-0.5 rounded text-[8px] font-bold text-white bg-indigo-400">${p}</span>`).join('')}
                        </div>
                        <h4 class="font-bold text-xs text-slate-800">${r.keyword}</h4>
                        <p class="text-[10px] text-slate-400 truncate mt-1">${r.text}</p>
                        <button onclick="rules.splice(${i},1);localStorage.setItem('vault_'+document.getElementById('accountKey').value, JSON.stringify(rules));renderUI()" class="absolute top-4 right-4 text-slate-300 hover:text-red-500 transition">âŒ</button>
                    </div>`;
            });
            document.getElementById('outputCode').innerText = `const REPLY_RULES = ${JSON.stringify(rules, null, 2)};`;
        }

        function copyCode() {
            const code = document.getElementById('outputCode').innerText;
            navigator.clipboard.writeText(code).then(() => alert('ä»£ç¢¼å·²è¤‡è£½ï¼è«‹ä¾ç…§å³å´æ•™å­¸é€²è¡Œéƒ¨ç½² ğŸ‘‘'));
        }

        function clearAll() {
            if(confirm('ç¢ºå®šæ¸…é™¤ï¼Ÿ')) {
                rules = [];
                localStorage.removeItem('vault_' + document.getElementById('accountKey').value);
                renderUI();
            }
        }
    </script>
    <script src="/assets/js/api.js"></script>
</body>
</html>

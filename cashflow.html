<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤§å¿ƒè²¡å¯Œé ˜èˆªç³»çµ± - æå˜‰å“²Gavin</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-color: #4A90E2; /* å°ˆæ¥­è— */
            --accent-color: #FF6B6B; /* å¤§å¿ƒç²‰ç´… */
            --bg-color: #F7F9FC;
            --card-bg: #FFFFFF;
            --text-color: #333333;
            --success-color: #4CAF50;
        }

        body {
            font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding-bottom: 50px;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            color: var(--primary-color);
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .subtitle {
            color: #666;
            font-size: 0.9em;
        }

        /* éš±ç§è²æ˜æ¨™ç±¤ */
        .privacy-badge {
            background-color: #e8f5e9;
            color: #2e7d32;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.8em;
            display: inline-block;
            margin-top: 10px;
            border: 1px solid #c8e6c9;
        }

        .card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            transition: transform 0.2s;
        }

        h2 {
            border-left: 5px solid var(--accent-color);
            padding-left: 15px;
            margin-top: 0;
            font-size: 1.3em;
            color: #444;
        }

        .input-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-control {
            margin-bottom: 10px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            font-size: 0.95em;
        }

        input, select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            box-sizing: border-box;
            background-color: #fafafa;
        }

        input:focus {
            border-color: var(--primary-color);
            outline: none;
            background-color: #fff;
            box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
        }

        .unit-tag {
            font-size: 0.8em;
            color: #888;
            text-align: right;
            margin-top: -35px;
            margin-right: 10px;
            margin-bottom: 20px;
            pointer-events: none;
            position: relative;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        button.calculate-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1em;
            border-radius: 50px;
            cursor: pointer;
            flex: 2;
            font-weight: bold;
            box-shadow: 0 4px 10px rgba(74, 144, 226, 0.3);
            transition: all 0.3s;
        }

        button.save-btn {
            background-color: var(--success-color);
            color: white;
            border: none;
            padding: 15px 20px;
            font-size: 1em;
            border-radius: 50px;
            cursor: pointer;
            flex: 1;
            box-shadow: 0 4px 10px rgba(76, 175, 80, 0.3);
            transition: all 0.3s;
        }

        button:hover {
            transform: translateY(-2px);
            opacity: 0.9;
        }

        .result-section {
            display: none;
            animation: fadeIn 0.6s ease-out;
        }

        /* é¼“å‹µå°èªå€å¡Š */
        .encouragement-box {
            background: linear-gradient(135deg, #fff 0%, #fff5f5 100%);
            border: 2px dashed var(--accent-color);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 25px;
            position: relative;
        }

        .encouragement-text {
            font-size: 1.1em;
            color: #555;
            font-style: italic;
            margin-top: 10px;
        }

        .progress-bar-container {
            background-color: #eee;
            border-radius: 20px;
            height: 25px;
            width: 100%;
            margin: 15px 0;
            overflow: hidden;
            position: relative;
        }

        .progress-bar {
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
            height: 100%;
            width: 0%;
            border-radius: 20px;
            transition: width 1s ease-in-out;
        }

        .amway-chart-container {
            margin-top: 20px;
            position: relative;
            height: 350px;
        }

        .footer {
            text-align: center;
            margin-top: 40px;
            color: #999;
            font-size: 0.8em;
            padding-bottom: 20px;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .amway-levels {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }
        
        .level-card {
            background: #fff;
            border: 1px solid #eee;
            padding: 8px;
            border-radius: 8px;
            text-align: center;
            font-size: 0.85em;
            flex: 1 0 21%;
            color: #666;
        }
        .level-card strong { display: block; color: var(--accent-color); font-size: 1.1em; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>ğŸ’– å¤§å¿ƒè²¡å¯Œé ˜èˆªç³»çµ±</h1>
        <div class="subtitle">ç‚ºä½ é‡èº«æ‰“é€ çš„è²¡å¯Œè‡ªç”±è—åœ–</div>
        <div class="privacy-badge">ğŸ”’ éš±ç§å®‰å…¨ï¼šæ‚¨çš„è³‡æ–™åƒ…å„²å­˜åœ¨æ­¤è£ç½®ï¼Œä»–äººç„¡æ³•æŸ¥çœ‹</div>
    </header>

    <div class="card">
        <h2>1. å€‹äººç¾æ³èˆ‡å¤¢æƒ³ (å–®ä½ï¼šè¬å…ƒ)</h2>
        <div class="input-group">
            <div class="form-control">
                <label>ğŸ‘¤ ç›®å‰å¹´é½¡</label>
                <input type="number" id="currentAge" placeholder="è¼¸å…¥æ‚¨çš„å¹´é½¡">
            </div>
            <div class="form-control">
                <label>ğŸ¯ å¤¢æƒ³ç¸½è³‡ç”¢ç›®æ¨™</label>
                <input type="number" id="dreamGoal" placeholder="ä¾‹å¦‚ï¼š3000">
                <div class="unit-tag">è¬å…ƒ</div>
            </div>
            <div class="form-control">
                <label>ğŸ’° ç›®å‰å·²ç´¯ç©æ·¨è³‡ç”¢</label>
                <input type="number" id="currentAssets" placeholder="ç›®å‰å­˜æ¬¾+æŠ•è³‡">
                <div class="unit-tag">è¬å…ƒ</div>
            </div>
        </div>
        <div class="form-control">
            <label>ğŸ“‰ é ä¼°é€šè²¨è†¨è„¹ç‡ (%)</label>
            <input type="number" id="inflationRate" value="2.5" step="0.1">
        </div>
    </div>

    <div class="card">
        <h2>2. æ”¶å…¥çµæ§‹ (å¹´æ”¶å…¥/å–®ä½ï¼šè¬å…ƒ)</h2>
        <h3>ğŸ’¼ ä¸»å‹•æ”¶å…¥ (æœ¬é‡‘ä¾†æº)</h3>
        <div class="input-group">
            <div class="form-control">
                <label>æœ¬æ¥­è–ªè³‡</label>
                <input type="number" id="salary" placeholder="0">
                <div class="unit-tag">è¬å…ƒ</div>
            </div>
            <div class="form-control">
                <label>å‰¯æ¥­/å…¶ä»–ä¸»å‹•</label>
                <input type="number" id="sideHustle" placeholder="0">
                <div class="unit-tag">è¬å…ƒ</div>
            </div>
        </div>

        <h3>ğŸ“ˆ è¢«å‹•æ”¶å…¥ (è‡ªç”±ä¹‹é‘°)</h3>
        <div class="input-group">
            <div class="form-control">
                <label>è‚¡ç¥¨/åŸºé‡‘é…æ¯ (æµ·å¤–)</label>
                <input type="number" id="stockDiv" placeholder="ç¾è‚¡ETFç­‰">
                <div class="unit-tag">è¬å…ƒ</div>
                <small style="color:#aaa; font-size:0.75em;">*æµ·å¤–æ‰€å¾—750è¬å…§å…ç¨…</small>
            </div>
            <div class="form-control">
                <label>æˆ¿ç§Ÿæ”¶å…¥</label>
                <input type="number" id="rentIncome" placeholder="0">
                <div class="unit-tag">è¬å…ƒ</div>
            </div>
            <div class="form-control">
                <label>ç›®å‰å®‰éº—è¢«å‹•æ”¶å…¥ (å¹´)</label>
                <input type="number" id="currentAmway" placeholder="0">
                <div class="unit-tag">è¬å…ƒ</div>
            </div>
            <div class="form-control">
                <label>å…¶ä»–è¢«å‹•æ”¶å…¥</label>
                <input type="number" id="otherPassive" placeholder="0">
                <div class="unit-tag">è¬å…ƒ</div>
            </div>
        </div>
    </div>

    <div class="card">
        <h2>3. æœˆæ”¯å‡ºçµæ§‹ (å–®ä½ï¼šè¬å…ƒ/æœˆ)</h2>
        <div class="input-group">
            <div class="form-control">
                <label>æˆ¿è²¸/æˆ¿ç§Ÿ</label>
                <input type="number" id="expHousing" placeholder="0">
                <div class="unit-tag">è¬å…ƒ/æœˆ</div>
            </div>
            <div class="form-control">
                <label>è»Šè²¸/äº¤é€š</label>
                <input type="number" id="expCar" placeholder="0">
                <div class="unit-tag">è¬å…ƒ/æœˆ</div>
            </div>
            <div class="form-control">
                <label>ä¿éšªè²»</label>
                <input type="number" id="expIns" placeholder="0">
                <div class="unit-tag">è¬å…ƒ/æœˆ</div>
            </div>
            <div class="form-control">
                <label>ç”Ÿæ´»/å…¶ä»–</label>
                <input type="number" id="expLife" placeholder="0">
                <div class="unit-tag">è¬å…ƒ/æœˆ</div>
            </div>
        </div>
    </div>

    <div class="card">
        <h2>4. å®‰éº—äº‹æ¥­åŠ é€Ÿå™¨</h2>
        <label>é¸æ“‡ç›®æ¨™è˜ä½ï¼Œçœ‹è¦‹æœªä¾†çš„å¯èƒ½æ€§ï¼š</label>
        <select id="targetAmwayLevel" style="margin-top:10px; font-weight:bold; color:var(--primary-color);">
            <option value="0">-- é¸æ“‡ç›®æ¨™è˜ä½ --</option>
            <option value="100">ç™½é‡‘ (å¹´æ”¶ç´„ 100è¬)</option>
            <option value="180">è—å¯¶çŸ³ (å¹´æ”¶ç´„ 180è¬)</option>
            <option value="250">ç¿¡ç¿  (å¹´æ”¶ç´„ 250è¬)</option>
            <option value="500">é‘½çŸ³ (å¹´æ”¶ç´„ 500è¬)</option>
            <option value="700">åŸ·è¡Œå°ˆæ‰ EDC (å¹´æ”¶ç´„ 700è¬)</option>
            <option value="1000">çš‡å†  (å¹´æ”¶ç´„ 1000è¬)</option>
            <option value="3000">çš‡å† å¤§ä½¿ (å¹´æ”¶ç´„ 3000è¬)</option>
        </select>
        
        <div class="amway-levels">
            <div class="level-card"><strong>ç™½é‡‘</strong>100è¬</div>
            <div class="level-card"><strong>ç¿¡ç¿ </strong>250è¬</div>
            <div class="level-card"><strong>é‘½çŸ³</strong>500è¬</div>
            <div class="level-card"><strong>çš‡å† </strong>1000è¬</div>
        </div>
    </div>

    <div class="action-buttons">
        <button class="calculate-btn" onclick="calculateFreedom()">ğŸš€ é–‹å§‹è©•ä¼°</button>
        <button class="save-btn" onclick="saveData()">ğŸ’¾ æš«å­˜è³‡æ–™</button>
    </div>
    <div style="text-align:center; margin-top:10px; font-size:0.8em; color:#888;">
        *é»æ“Šã€Œæš«å­˜è³‡æ–™ã€å¯å°‡è¼¸å…¥æ•¸å€¼ä¿å­˜åœ¨æ­¤ç€è¦½å™¨ï¼Œæ–¹ä¾¿ä¸‹æ¬¡ä½¿ç”¨ã€‚
    </div>

    <div id="resultSection" class="result-section card" style="margin-top: 30px;">
        <h2 style="border-color: #4CAF50;">ğŸ“Š æ‚¨çš„è²¡å¯Œè‡ªç”±å ±å‘Š</h2>
        
        <div class="encouragement-box">
            <h3 id="freedomTitle" style="margin:0; color:var(--primary-color);">åˆ†æä¸­...</h3>
            
            <div class="progress-bar-container">
                <div id="freedomProgress" class="progress-bar"></div>
            </div>
            <div style="font-size:0.9em; color:#666;">
                ç›®å‰è¢«å‹•æ”¶å…¥æ¶µè“‹ç‡ï¼š<span id="coverageRatio" style="font-weight:bold; font-size:1.2em; color:#333;">0%</span>
            </div>
            
            <hr style="border:0; border-top:1px dashed #ddd; margin:15px 0;">
            
            <div id="encouragementText" class="encouragement-text">
                </div>
        </div>

        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:20px; margin-bottom:30px;">
            <div style="background:#f9f9f9; padding:15px; border-radius:10px;">
                <h3 style="margin-top:0; font-size:1em;">ğŸ¢ ç¶­æŒç¾ç‹€é ä¼°</h3>
                <p>é”æˆå¤¢æƒ³å¹´é½¡ï¼š</p>
                <div id="ageCurrent" style="font-size:1.8em; font-weight:bold; color:#666;">-- æ­²</div>
            </div>
            <div style="background:#fff0f0; padding:15px; border-radius:10px; border:1px solid #ffdcdc;">
                <h3 style="margin-top:0; font-size:1em; color:var(--accent-color);">ğŸ° åŠ ä¸Šå®‰éº—ç›®æ¨™ (<span id="targetLevelName">--</span>)</h3>
                <p>é”æˆå¤¢æƒ³å¹´é½¡ï¼š</p>
                <div id="ageAmway" style="font-size:2.2em; font-weight:bold; color:var(--accent-color);">-- æ­²</div>
                <div style="font-size:0.9em; color:#4CAF50; font-weight:bold; margin-top:5px;">
                    âœ¨ ææ—© <span id="yearsSaved">0</span> å¹´é€€ä¼‘ï¼
                </div>
            </div>
        </div>

        <div class="amway-chart-container">
            <canvas id="wealthChart"></canvas>
        </div>
    </div>

    <div class="footer">
        Made with â¤ï¸ by æå˜‰å“² Gavin | å¤§å¿ƒåœ˜éšŠ<br>
        <span style="font-size:0.9em">æ­¤å·¥å…·åƒ…ä¾›è¦åŠƒåƒè€ƒï¼Œä¸ä»£è¡¨æŠ•è³‡æ”¶ç›Šä¿è­‰</span>
    </div>
</div>

<script>
    // é é¢è¼‰å…¥æ™‚è®€å–è³‡æ–™
    window.onload = function() {
        loadData();
    };

    function getValue(id) {
        return parseFloat(document.getElementById(id).value) || 0;
    }

    function calculateFreedom() {
        // 1. ç²å–æ•¸å€¼
        const currentAge = getValue('currentAge') || 30; // é è¨­30æ­²ä»¥å…åœ–è¡¨å£æ‰
        const dreamGoal = getValue('dreamGoal');
        const currentAssets = getValue('currentAssets');
        const inflationRate = getValue('inflationRate') / 100;

        // æ”¶å…¥
        const salary = getValue('salary');
        const sideHustle = getValue('sideHustle');
        const stockDiv = getValue('stockDiv'); // æµ·å¤–
        const rentIncome = getValue('rentIncome');
        const currentAmway = getValue('currentAmway');
        const otherPassive = getValue('otherPassive');

        // æ”¯å‡º (æœˆè½‰å¹´)
        const monthlyExp = (
            getValue('expHousing') +
            getValue('expCar') +
            getValue('expIns') +
            getValue('expLife')
        );
        const annualExp = monthlyExp * 12;

        // ç›®æ¨™å®‰éº—
        const targetAmwaySelect = document.getElementById('targetAmwayLevel');
        const targetAmwayIncome = parseFloat(targetAmwaySelect.value) || 0;
        const targetLevelName = targetAmwaySelect.options[targetAmwaySelect.selectedIndex].text.split(' ')[0];

        // 2. ç¨…å‹™è¨ˆç®— (ç°¡æ˜“ç‰ˆ)
        const domesticIncome = salary + sideHustle + rentIncome + otherPassive + currentAmway;
        const taxDomestic = domesticIncome * 0.12; 
        
        let taxOverseas = 0;
        if (stockDiv > 100 && (stockDiv + domesticIncome) > 750) {
            taxOverseas = (stockDiv - 670) * 0.2; 
            if(taxOverseas < 0) taxOverseas = 0;
        }

        const totalTax = taxDomestic + taxOverseas;

        // 3. ç¾é‡‘æµ
        const totalPassive = stockDiv + rentIncome + currentAmway + otherPassive;
        const netAnnualIncomeCurrent = (domesticIncome + stockDiv) - totalTax - annualExp;
        
        // åŠ ä¸Šå®‰éº—ç›®æ¨™å¾Œçš„æ”¶å…¥
        let addedAmwayIncome = targetAmwayIncome - currentAmway;
        if (addedAmwayIncome < 0) addedAmwayIncome = 0;
        
        const amwayTax = addedAmwayIncome * 0.2; 
        const netAnnualIncomeWithAmway = netAnnualIncomeCurrent + addedAmwayIncome - amwayTax;

        // 4. è²¡å¯Œè‡ªç”±é€²åº¦èˆ‡é¼“å‹µæ©Ÿåˆ¶
        const coverageRatio = annualExp > 0 ? (totalPassive / annualExp * 100) : 0;
        const ratioFixed = coverageRatio.toFixed(1);
        
        // æ›´æ–°é€²åº¦æ¢
        const progressBar = document.getElementById('freedomProgress');
        progressBar.style.width = Math.min(coverageRatio, 100) + "%";

        // è¨­å®šé¼“å‹µè©±èª
        const titleEl = document.getElementById('freedomTitle');
        const textEl = document.getElementById('encouragementText');
        
        if (coverageRatio >= 100) {
            titleEl.textContent = "ğŸ‰ æ­å–œé”æˆè²¡å¯Œè‡ªç”±ï¼";
            titleEl.style.color = "#4CAF50";
            textEl.textContent = "å¤ªæ£’äº†ï¼æ‚¨çš„è¢«å‹•æ”¶å…¥å·²ç¶“å¤§æ–¼ç¸½æ”¯å‡ºã€‚æ‚¨å·²ç¶“æ‰“é€ äº†å±¬æ–¼è‡ªå·±çš„ç¾é‡‘æµç³»çµ±ï¼Œæ¥ä¸‹ä¾†å¯ä»¥æ€è€ƒå¦‚ä½•æ“´å¤§å½±éŸ¿åŠ›ï¼Œå¹«åŠ©æ›´å¤šäººï¼ğŸŒŸ";
        } else if (coverageRatio >= 70) {
            titleEl.textContent = "ğŸš€ è¡åˆºéšæ®µï¼Œå³å°‡èµ·é£›ï¼";
            titleEl.style.color = "#FF9800";
            textEl.textContent = "æ‚¨å·²ç¶“åšå¾—éå¸¸å¥½äº†ï¼è·é›¢è‡ªç”±åªå·®æœ€å¾Œä¸€å“©è·¯ã€‚å …æŒæ‚¨çš„ç³»çµ±å»ºè¨­ï¼Œè¤‡åˆ©çš„å¨åŠ›å³å°‡çˆ†ç™¼ã€‚ç›¸ä¿¡è‡ªå·±ï¼Œæ‚¨ä¸€å®šåšå¾—åˆ°ï¼ğŸ’ª";
        } else if (coverageRatio >= 30) {
            titleEl.textContent = "ğŸŒ± åŸºç¤ç©©å›ºï¼ŒæŒçºŒç´¯ç©ï¼";
            titleEl.style.color = "#2196F3";
            textEl.textContent = "æ‚¨å·²ç¶“å»ºç«‹äº†åˆæ­¥çš„è¢«å‹•æ”¶å…¥ç®¡é“ï¼Œé€™æ˜¯å¾ˆæ£’çš„é–‹å§‹ï¼åªè¦æŒçºŒå„ªåŒ–è³‡ç”¢é…ç½®ä¸¦ç™¼å±•å®‰éº—äº‹æ¥­ï¼Œé€™æ¢æ°´ç®¡æœƒè¶Šä¾†è¶Šç²—ã€‚ä¿æŒè€å¿ƒï¼Œæ™‚é–“æ˜¯æ‚¨çš„æœ‹å‹ï¼ğŸ’§";
        } else {
            titleEl.textContent = "ğŸŒŸ è¬ä¸ˆé«˜æ¨“å¹³åœ°èµ·ï¼";
            titleEl.style.color = "#666";
            textEl.textContent = "æ¯ä¸€å€‹å‰å¤§çš„æˆå°±éƒ½å§‹æ–¼ç¬¬ä¸€æ­¥ã€‚ç¾åœ¨æ˜¯ç›¤é»è³‡æºã€è¨­å®šç›®æ¨™çš„æœ€ä½³æ™‚æ©Ÿã€‚é‹ç”¨å¤§å¿ƒåœ˜éšŠçš„è³‡æºèˆ‡å®‰éº—çš„æ©Ÿæœƒï¼Œæ‚¨çµ•å°æœ‰èƒ½åŠ›æ”¹è®Šç¾ç‹€ã€‚è®“æˆ‘å€‘ä¸€èµ·åŠ æ²¹ï¼ğŸŒ±";
        }

        // 5. è¨ˆç®—å¹´æ•¸
        function calculateYearsToGoal(current, annualSaving, goal) {
            if (annualSaving <= 0) return 999; 
            let assets = current;
            let years = 0;
            while (assets < goal && years < 100) {
                assets = assets * 1.05 + annualSaving; // å‡è¨­5%æŠ•å ±
                years++;
            }
            return years;
        }

        const yearsCurrent = calculateYearsToGoal(currentAssets, netAnnualIncomeCurrent, dreamGoal);
        const yearsWithAmway = calculateYearsToGoal(currentAssets, netAnnualIncomeWithAmway, dreamGoal);

        // 6. æ›´æ–°UI
        document.getElementById('resultSection').style.display = 'block';
        document.getElementById('coverageRatio').textContent = ratioFixed + "%";
        
        document.getElementById('ageCurrent').textContent = (yearsCurrent > 90) ? "> 100 æ­²" : (currentAge + yearsCurrent) + " æ­²";
        document.getElementById('targetLevelName').textContent = targetLevelName == "--" ? "æœªé¸æ“‡" : targetLevelName;
        
        if (targetAmwayIncome > 0 && yearsWithAmway < 100) {
            document.getElementById('ageAmway').textContent = (currentAge + yearsWithAmway) + " æ­²";
            const saved = (yearsCurrent > 90 ? 100 : yearsCurrent) - yearsWithAmway;
            document.getElementById('yearsSaved').textContent = saved > 0 ? saved : 0;
        } else {
            document.getElementById('ageAmway').textContent = "--";
            document.getElementById('yearsSaved').textContent = "0";
        }

        drawChart(currentAge, yearsCurrent, yearsWithAmway, dreamGoal);
        
        // æ»¾å‹•åˆ°çµæœ
        document.getElementById('resultSection').scrollIntoView({behavior: 'smooth'});
    }

    let myChart = null;
    function drawChart(startAge, yearsA, yearsB, goal) {
        const ctx = document.getElementById('wealthChart').getContext('2d');
        if (myChart) myChart.destroy();

        const maxYears = Math.min(Math.max(yearsA < 90 ? yearsA : 50, yearsB < 90 ? yearsB : 50) + 5, 60);
        const labels = [];
        const dataA = [];
        const dataB = [];
        
        for (let i = 0; i <= maxYears; i++) {
            labels.push(startAge + i + "æ­²");
            dataA.push(yearsA > 90 ? 0 : Math.min(goal, (i / yearsA) * goal)); 
            dataB.push(yearsB > 90 ? 0 : Math.min(goal, (i / yearsB) * goal));
        }

        myChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: labels,
                datasets: [{
                    label: 'ç¶­æŒç¾ç‹€',
                    data: dataA,
                    borderColor: '#ccc',
                    borderWidth: 2,
                    fill: false,
                    pointRadius: 0
                }, {
                    label: 'åŠ ä¸Šå®‰éº—äº‹æ¥­',
                    data: dataB,
                    borderColor: '#FF6B6B',
                    backgroundColor: 'rgba(255, 107, 107, 0.1)',
                    borderWidth: 3,
                    fill: true,
                    pointRadius: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                interaction: { intersect: false, mode: 'index' },
                plugins: {
                    title: { display: true, text: 'è³‡ç”¢ç´¯ç©é€Ÿåº¦é æ¸¬' }
                }
            }
        });
    }

    // --- å„²å­˜èˆ‡è®€å–åŠŸèƒ½ (Local Storage) ---
    function saveData() {
        const inputs = document.querySelectorAll('input, select');
        const data = {};
        inputs.forEach(input => {
            data[input.id] = input.value;
        });
        localStorage.setItem('wealthNavigatorData', JSON.stringify(data));
        alert('âœ… è³‡æ–™å·²æš«å­˜ï¼\næ‚¨çš„éš±ç§çµ•å°å®‰å…¨ï¼Œè³‡æ–™åƒ…ä¿ç•™åœ¨æ‚¨ç›®å‰çš„è£ç½®èˆ‡ç€è¦½å™¨ä¸­ã€‚');
    }

    function loadData() {
        const savedData = localStorage.getItem('wealthNavigatorData');
        if (savedData) {
            const data = JSON.parse(savedData);
            for (const key in data) {
                const el = document.getElementById(key);
                if (el) el.value = data[key];
            }
        }
    }
</script>

</body>
</html>

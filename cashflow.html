<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¤§å¿ƒå¤¥ä¼´å¤¢æƒ³é”æˆå™¨ ğŸ¦„</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* --- å¤¢æƒ³æ¥µå…‰ä¸»é¡Œ (Dream Aurora Theme) --- */
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --accent-color: #f72585; /* å¤¢æƒ³ç²‰ */
            --success-color: #06d6a0;
            --warning-color: #ffd166;
            --text-dark: #2d3436;
            --card-bg: rgba(255, 255, 255, 0.95);
            --bg-body: #f3f4f6;
        }

        body { 
            background: #e0eafc; 
            background: linear-gradient(to bottom, #e0eafc, #cfdef3); 
            font-family: "Microsoft JhengHei", sans-serif; 
            padding-bottom: 120px; 
            color: var(--text-dark); 
        }

        /* å°èˆª */
        .navbar { 
            background: white; 
            box-shadow: 0 4px 20px rgba(0,0,0,0.05); 
        }
        .navbar-brand { 
            background: -webkit-linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 900; 
            letter-spacing: 1px; 
        }

        /* å¡ç‰‡é€šç”¨è¨­å®š */
        .card { 
            border: none; 
            border-radius: 20px; 
            box-shadow: 0 10px 25px rgba(118, 75, 162, 0.1); 
            margin-bottom: 20px; 
            background: var(--card-bg); 
            backdrop-filter: blur(10px);
            overflow: hidden;
        }

        /* --- 1. ä¸»è§’ï¼šç¸½çµå¡ç‰‡ --- */
        .summary-card {
            border-top: 6px solid #764ba2;
            position: relative;
        }
        .summary-title {
            font-size: 1.1rem; font-weight: 800; color: #4a4a4a; margin-bottom: 15px; display: flex; align-items: center;
        }
        .summary-title i { color: #764ba2; font-size: 1.3rem; margin-right: 8px; }
        
        .tax-row {
            display: flex; justify-content: space-between; align-items: center;
            padding: 8px 0; border-bottom: 1px dashed #ddd; font-size: 0.95rem;
        }
        .tax-val { font-weight: 800; color: var(--text-dark); }
        .tax-highlight { color: #d63031; }

        /* é”æˆå¹´é½¡å°æ¯”å€ */
        .age-comparison {
            display: flex; gap: 10px; margin-top: 15px;
        }
        .age-box {
            flex: 1; padding: 15px 10px; border-radius: 12px; text-align: center;
            background: #f8f9fa; border: 1px solid #eee;
        }
        .age-box.highlight {
            background: linear-gradient(135deg, #fff0f5 0%, #fff 100%);
            border: 1px solid #f72585;
        }
        .age-label { font-size: 0.8rem; color: #888; font-weight: bold; margin-bottom: 5px; display: block; }
        .age-value { font-size: 1.4rem; font-weight: 900; color: #2d3436; }
        .age-value.win { color: #f72585; }

        /* --- 2. è˜ä½å»ºè­° --- */
        .pin-suggestion {
            margin-top: 15px; padding: 15px; border-radius: 12px;
            background: linear-gradient(to right, #667eea, #764ba2);
            color: white; display: flex; align-items: center;
            box-shadow: 0 5px 15px rgba(118, 75, 162, 0.3);
        }
        .pin-icon { font-size: 2.5rem; margin-right: 15px; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3)); }
        .pin-text h5 { margin: 0; font-weight: 900; font-size: 1.2rem; }
        .pin-text p { margin: 0; font-size: 0.85rem; opacity: 0.9; }

        /* --- è¼¸å…¥å€èˆ‡åˆ—è¡¨ --- */
        .input-group-text { background: #f1f3f5; border: none; font-weight: 600; color: #555; }
        .form-control { border: 1px solid #e9ecef; font-weight: 600; }
        .form-control:focus { box-shadow: none; border-color: #764ba2; }
        
        .section-header {
            font-size: 1rem; font-weight: 800; color: #555; margin-bottom: 12px;
            padding-left: 10px; border-left: 4px solid #ddd;
        }
        .header-income { border-color: #06d6a0; }
        .header-dream { border-color: #f72585; }
        
        .wan-tag {
            position: absolute; right: 30px; top: 50%; transform: translateY(-50%);
            font-size: 0.8rem; color: #aaa; pointer-events: none; font-weight: bold;
        }
        
        /* å‹•æ…‹åˆ—è¡¨ */
        .dynamic-row { background: white; padding: 12px; border-radius: 10px; margin-bottom: 10px; border: 1px solid #f0f0f0; position: relative; }
        .btn-remove { position: absolute; top: 5px; right: 5px; color: #ddd; background: none; border: none; }
        .btn-remove:hover { color: #ff6b6b; }

        /* æº«é¦¨èªéŒ„ */
        .warm-quote {
            text-align: center; color: #888; font-size: 0.85rem; font-style: italic; margin-top: 20px;
        }
        
        .unit-select { max-width: 70px; background: #f8f9fa; border: 1px solid #e9ecef; font-size: 0.85rem; font-weight: bold;}
    </style>
</head>
<body>

<nav class="navbar sticky-top">
    <div class="container-fluid d-flex justify-content-between align-items-center">
        <span class="navbar-brand"><i class="fas fa-star me-2"></i>å¤§å¿ƒå¤¢æƒ³é”æˆå™¨</span>
        <button class="btn btn-sm btn-dark rounded-pill fw-bold" onclick="saveData()"><i class="fas fa-save me-1"></i> ç´€éŒ„</button>
    </div>
</nav>

<div class="container mt-3">

    <div class="card summary-card">
        <div class="card-body">
            <div class="summary-title"><i class="fas fa-clipboard-check"></i> è²¡å‹™èˆ‡ç¨…å‹™ç¸½çµ (å¹´é ä¼°)</div>
            
            <div class="tax-row">
                <span>åœ‹å…§å¹´æ‰€å¾— (è–ªè³‡+å®‰éº—+è‚¡æ¯)</span>
                <span class="tax-val" id="summary-domestic">0 è¬</span>
            </div>
            <div class="tax-row">
                <span>é ä¼°åœ‹å…§æ‰€å¾—ç¨… (ç´„)</span>
                <span class="tax-val tax-highlight" id="summary-tax-dom">0</span>
            </div>
            <div class="tax-row">
                <span>æµ·å¤–å¹´æ‰€å¾—</span>
                <span class="tax-val" id="summary-overseas">0 è¬</span>
            </div>
            <div class="tax-row">
                <span>é ä¼°æµ·å¤–ç¨… (åŸºæœ¬æ‰€å¾— > 750è¬)</span>
                <span class="tax-val tax-highlight" id="summary-tax-ovs">0 (å…ç¨…)</span>
            </div>

            <div class="age-comparison">
                <div class="age-box">
                    <span class="age-label"><i class="fas fa-user-clock me-1"></i>æœ¬æ¥­é”æˆå¹´é½¡</span>
                    <span class="age-value" id="age-job-only">--</span>
                </div>
                <div class="age-box highlight">
                    <span class="age-label"><i class="fas fa-rocket me-1"></i>åŠ ä¸Šå®‰éº—é”æˆ</span>
                    <span class="age-value win" id="age-with-amway">--</span>
                </div>
            </div>

            <div class="pin-suggestion" id="pin-box" style="display:none;">
                <div class="pin-icon" id="pin-icon">ğŸ’</div>
                <div class="pin-text">
                    <h5 id="pin-title">å»ºè­°ç›®æ¨™ï¼šé‘½çŸ³</h5>
                    <p id="pin-desc">è£œè¶³ç¼ºå£ï¼Œææ—© 10 å¹´é€€ä¼‘ï¼</p>
                </div>
            </div>
        </div>
    </div>

    <div class="card">
        <div class="card-body">
            <div class="section-header header-dream">1. è¨­å®š & å¤¢æƒ³ (è¼¸å…¥å–®ä½ï¼šè¬)</div>
            
            <div class="row g-2 mb-3">
                <div class="col-12">
                    <div class="input-group">
                        <span class="input-group-text">ç›®å‰å¹´é½¡</span>
                        <input type="number" id="current-age" class="form-control" placeholder="ä¾‹å¦‚ 30" oninput="calculate()">
                        <span class="input-group-text">æ­²</span>
                    </div>
                </div>
            </div>

            <div class="d-flex justify-content-between align-items-center mb-2">
                <span class="small fw-bold text-muted">æˆ‘çš„å¤¢æƒ³æ¸…å–®</span>
                <button class="btn btn-sm btn-outline-primary rounded-pill" onclick="addDreamRow()">+ æ–°å¢å¤¢æƒ³</button>
            </div>
            <div id="dream-container"></div>
            
            <div class="alert alert-light small text-muted mt-2 mb-0 border-0" style="background:#f1f3f5;">
                <i class="fas fa-magic me-1 text-warning"></i> 
                è²·æˆ¿/è»Šæœƒè‡ªå‹•è½‰ç‚ºè²¸æ¬¾(è¨ˆå…¥æœˆæ”¯å‡º)ï¼›å…¨æ¬¾é …ç›®å‰‡è¨ˆç®—ã€Œå­˜éŒ¢é€Ÿåº¦ã€ã€‚
            </div>
        </div>
    </div>

    <div class="card">
        <div class="card-body">
            <div class="section-header header-income">2. æ”¶å…¥å¡«å¯« (è¼¸å…¥å–®ä½ï¼šè¬)</div>
            
            <div class="input-group mb-2">
                <span class="input-group-text">æœ¬æ¥­è–ªè³‡</span>
                <input type="number" id="income-active" class="form-control" placeholder="è¬" oninput="calculate()">
                <select class="form-select unit-select" id="unit-active" onchange="calculate()">
                    <option value="month">æœˆ</option>
                    <option value="year">å¹´</option>
                </select>
            </div>

            <hr style="opacity:0.1">
            
            <div class="input-group mb-2">
                <span class="input-group-text fw-bold text-primary">å®‰éº—æ”¶å…¥</span>
                <input type="number" id="income-amway" class="form-control" placeholder="è¬" oninput="calculate()">
                <select class="form-select unit-select" id="unit-amway" onchange="calculate()">
                    <option value="month">æœˆ</option>
                    <option value="year">å¹´</option>
                </select>
            </div>

            <div class="row g-2">
                <div class="col-6">
                    <div class="input-group input-group-sm">
                        <span class="input-group-text">åœ‹å…§è‚¡æ¯</span>
                        <input type="number" id="income-stock" class="form-control" placeholder="å¹´é ˜(è¬)" oninput="calculate()">
                    </div>
                </div>
                <div class="col-6">
                    <div class="input-group input-group-sm">
                        <span class="input-group-text">æˆ¿ç§Ÿ</span>
                        <input type="number" id="income-rent" class="form-control" placeholder="æœˆæ”¶(è¬)" oninput="calculate()">
                    </div>
                </div>
                <div class="col-12">
                    <div class="input-group input-group-sm">
                        <span class="input-group-text">æµ·å¤–é…æ¯</span>
                        <input type="number" id="income-overseas" class="form-control" placeholder="å¹´é ˜é‡‘é¡" oninput="calculate()">
                        <select class="form-select unit-select" id="unit-overseas" onchange="calculate()">
                            <option value="wan">è¬(å°)</option>
                            <option value="usd">ç¾é‡‘</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="card">
        <div class="card-body">
            <div class="section-header" style="border-color:#ff7675;">3. æ”¯å‡ºèˆ‡è² å‚µ (è¼¸å…¥å–®ä½ï¼šè¬)</div>
            
            <label class="small text-muted fw-bold">ç¾æœ‰è² å‚µ (ä¸å«å¤¢æƒ³)</label>
            <div id="loan-container"></div>
            <button class="btn btn-sm btn-outline-danger w-100 mb-3 dashed" onclick="addLoanRow()">+ æ–°å¢è² å‚µ (ä¿¡è²¸/å­¸è²¸)</button>

            <label class="small text-muted fw-bold">ä¿éšª (å¹´ç¹³/æœˆç¹³)</label>
            <div id="insurance-container"></div>
            <button class="btn btn-sm btn-outline-info w-100 mb-3 dashed" onclick="addInsRow()">+ æ–°å¢ä¿éšª</button>

            <div class="input-group">
                <span class="input-group-text">ç”Ÿæ´»æœˆé–‹éŠ·</span>
                <input type="number" id="expense-living" class="form-control" placeholder="è¬" oninput="calculate()">
            </div>
        </div>
    </div>

    <div class="accordion mb-4" id="assetAcc">
        <div class="accordion-item border-0" style="background:transparent;">
            <h2 class="accordion-header">
                <button class="accordion-button collapsed rounded-3 shadow-sm fw-bold" type="button" data-bs-toggle="collapse" data-bs-target="#collapseAsset" style="background:white;">
                    ğŸ’ 4. ç¾æœ‰è³‡ç”¢ (è¼¸å…¥çœŸå¯¦é‡‘é¡)
                </button>
            </h2>
            <div id="collapseAsset" class="accordion-collapse collapse" data-bs-parent="#assetAcc">
                <div class="accordion-body bg-white rounded-bottom-3 shadow-sm">
                    <div class="row g-2">
                        <div class="col-6"><input type="number" class="form-control form-control-sm asset-item" placeholder="å­˜æ¬¾(è¬)" oninput="calculate()"></div>
                        <div class="col-6"><input type="number" class="form-control form-control-sm asset-item" placeholder="è‚¡ç¥¨(è¬)" oninput="calculate()"></div>
                        <div class="col-6"><input type="number" class="form-control form-control-sm asset-item" placeholder="åŸºé‡‘(è¬)" oninput="calculate()"></div>
                        <div class="col-6"><input type="number" class="form-control form-control-sm asset-item" placeholder="å…¶ä»–(è¬)" oninput="calculate()"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="quote-area" class="warm-quote"></div>
    <div class="text-center text-muted small pb-4 mt-2" style="opacity:0.5; font-size:0.7rem;">Designed for Daxin Partners â€¢ Gavin</div>

</div>

<script>
    // åƒæ•¸è¨­å®š
    const RATES = { house: 0.022, car: 0.05, loan: 0.06, invest: 0.05, inflation: 0.03 };
    const USD_RATE = 32.5;
    const AMWAY_PINS = [
        { name: "ç™½é‡‘ (Platinum)", income: 100, icon: "ğŸ¥ˆ" },
        { name: "è—å¯¶çŸ³ (Sapphire)", income: 180, icon: "ğŸ”¹" },
        { name: "ç¿¡ç¿  (Emerald)", income: 250, icon: "ğŸ’š" },
        { name: "é‘½çŸ³ (Diamond)", income: 500, icon: "ğŸ’" },
        { name: "åŸ·è¡Œå°ˆæ‰ (EDC)", income: 700, icon: "ğŸ¢" },
        { name: "çš‡å†  (Crown)", income: 1000, icon: "ğŸ‘‘" },
        { name: "çš‡å† å¤§ä½¿ (CA)", income: 3000, icon: "ğŸŒ" }
    ];
    const QUOTES = [
        "æœ‰äº›äº‹ä¸æ˜¯çœ‹åˆ°å¸Œæœ›æ‰å …æŒï¼Œæ˜¯å …æŒäº†æ‰çœ‹åˆ°å¸Œæœ›ã€‚",
        "ä½ æƒ³è¦çš„è‡ªç”±ï¼Œè—åœ¨ä½ ç¾åœ¨çœ‹ä¸ä¸Šçš„è¢«å‹•æ”¶å…¥è£¡ã€‚",
        "ç¨®ä¸€æ£µæ¨¹æœ€å¥½çš„æ™‚é–“æ˜¯åå¹´å‰ï¼Œå…¶æ¬¡æ˜¯ç¾åœ¨ã€‚",
        "ç”¨å®‰éº—çš„ç¾é‡‘æµï¼Œæ’èµ·ä½ çš„å¤¢æƒ³æ¸…å–®ï¼"
    ];

    document.addEventListener('DOMContentLoaded', () => {
        document.getElementById('quote-area').innerText = QUOTES[Math.floor(Math.random() * QUOTES.length)];
        // é è¨­åŠ ä¸€åˆ—å¤¢æƒ³
        addDreamRow();
        calculate();
    });

    // æ ¸å¿ƒè¨ˆç®—
    function calculate() {
        // 1. æ”¶å…¥è™•ç† (å…¨éƒ¨è½‰ç‚º å¹´æ”¶å…¥ å–®ä½:è¬)
        let active = getVal('income-active') * (getUnit('unit-active') === 'month' ? 12 : 1);
        let amway = getVal('income-amway') * (getUnit('unit-amway') === 'month' ? 12 : 1);
        let stock = getVal('income-stock'); // å¹´
        let rent = getVal('income-rent') * 12; // æœˆè½‰å¹´
        
        let ovsVal = getVal('income-overseas');
        let ovsUnit = document.getElementById('unit-overseas').value;
        let overseas = (ovsUnit === 'usd') ? (ovsVal * USD_RATE / 10000) : ovsVal; // è½‰è¬

        let totalAnnualIncome = active + amway + stock + rent + overseas;
        let domesticIncome = active + amway + stock + rent;

        // 2. æ”¯å‡ºè™•ç† (å…¨éƒ¨è½‰ç‚º å¹´æ”¯å‡º å–®ä½:è¬)
        let loanPayment = 0; // ç¾æœ‰è² å‚µå¹´ä»˜
        document.querySelectorAll('.loan-row').forEach(row => {
            let m = Number(row.querySelector('.loan-m').value) || 0;
            loanPayment += m * 12;
        });

        let insPayment = 0; // ä¿éšªå¹´ä»˜
        document.querySelectorAll('.ins-row').forEach(row => {
            let amt = Number(row.querySelector('.ins-amt').value) || 0;
            let type = row.querySelector('.ins-type').value;
            insPayment += (type === 'year') ? amt : amt * 12;
        });

        let living = getVal('expense-living') * 12;

        // 3. å¤¢æƒ³é‚è¼¯ (æœ€é‡è¦)
        let dreamLoanPayment = 0; // å¤¢æƒ³è½‰è²¸æ¬¾çš„å¹´æ”¯å‡º
        let dreamFullTarget = 0;  // éœ€è¦å…¨æ¬¾çš„ç›®æ¨™ç¸½é¡
        
        document.querySelectorAll('.dream-row').forEach(row => {
            let cost = Number(row.querySelector('.dream-cost').value) || 0;
            let type = row.querySelector('.dream-cat').value; // house, car...
            
            // è‡ªå‹•åˆ¤æ–·å¹´é™
            let years = 0;
            if(type === 'house') years = 30;
            else if(type === 'car') years = 7;
            else if(type === 'custom_loan') years = 5; // è‡ªè¨‚è²¸æ¬¾é è¨­
            
            // å¦‚æœæ˜¯å…¨æ¬¾é …ç›®
            if (type === 'travel' || type === 'learn' || type === 'biz' || type === 'other') {
                dreamFullTarget += cost;
                row.querySelector('.dream-hint').innerText = `éœ€å­˜å…¨æ¬¾ ${cost} è¬`;
                row.querySelector('.dream-hint').style.color = "#f72585";
            } else {
                // è²¸æ¬¾é …ç›® (æœ¬æ¯æ”¤é‚„ç²—ä¼°)
                let rate = (type === 'house') ? RATES.house : RATES.car;
                // PMT å…¬å¼ç°¡åŒ–ä¼°ç®—: ç¸½åˆ©æ¯ç´„ç•¥
                let totalPay = cost * (1 + rate * years); 
                let annualPay = totalPay / years;
                dreamLoanPayment += annualPay;
                row.querySelector('.dream-hint').innerText = `è½‰æœˆä»˜ç´„ ${(annualPay/12).toFixed(1)} è¬ (${years}å¹´)`;
                row.querySelector('.dream-hint').style.color = "#764ba2";
            }
        });

        let totalAnnualExpense = loanPayment + insPayment + living + dreamLoanPayment;
        let annualSurplus = totalAnnualIncome - totalAnnualExpense; // å¹´çµé¤˜

        // 4. è³‡ç”¢ (ç¾æœ‰)
        let currentAssets = 0;
        document.querySelectorAll('.asset-item').forEach(i => currentAssets += Number(i.value) || 0);

        // 5. ç¨…å‹™è©¦ç®—
        let taxable = Math.max(0, domesticIncome - 42.3); // ç°¡æ˜“æ‰£é™¤é¡ 42.3è¬
        let taxDom = 0;
        if(taxable <= 59) taxDom = taxable * 0.05;
        else if(taxable <= 133) taxDom = taxable * 0.12 - 4.13;
        else if(taxable <= 266) taxDom = taxable * 0.20 - 14.77;
        else taxDom = taxable * 0.30 - 41.37;

        let taxOvs = 0;
        let basicIncome = domesticIncome + overseas;
        if(basicIncome > 750 && overseas > 100) taxOvs = (basicIncome - 750) * 0.20;

        // UI æ›´æ–° - ç¸½çµå¡
        document.getElementById('summary-domestic').innerText = domesticIncome.toFixed(1) + " è¬";
        document.getElementById('summary-overseas').innerText = overseas.toFixed(1) + " è¬";
        document.getElementById('summary-tax-dom').innerText = Math.floor(taxDom * 10000).toLocaleString() + " å…ƒ";
        document.getElementById('summary-tax-ovs').innerText = taxOvs > 0 ? Math.floor(taxOvs * 10000).toLocaleString() + " å…ƒ" : "0 (å…ç¨…)";

        // 6. å¹´é½¡é æ¸¬ (æ¼”ç®—æ³•)
        let age = Number(document.getElementById('current-age').value) || 30;
        
        // A. æœ¬æ¥­é”æˆå¹´é½¡
        // å‡è¨­åªé æœ¬æ¥­çµé¤˜ (æ‰£é™¤å®‰éº—)
        let jobSurplus = (active + stock + rent + overseas) - totalAnnualExpense; 
        // ç‚ºäº†è²·å…¨æ¬¾å¤¢æƒ³ï¼Œéœ€è¦å¤šä¹…ï¼Ÿ
        // å¦‚æœå¤¢æƒ³æ˜¯è²¸æ¬¾ï¼Œå·²ç¶“ç®—åœ¨æ”¯å‡ºè£¡ï¼Œåªè¦ Surplus > 0 å°±èƒ½æ’ä½ï¼Œå°±ç®—é”æˆ
        // å¦‚æœæœ‰å…¨æ¬¾å¤¢æƒ³ï¼Œè¦çœ‹ç´¯ç©è³‡ç”¢ä½•æ™‚ > ç›®æ¨™
        
        let yearsJob = 99;
        if (dreamFullTarget > 0) {
            if (jobSurplus > 0) yearsJob = Math.ceil((dreamFullTarget - currentAssets) / jobSurplus);
        } else {
            // æ²’æœ‰å…¨æ¬¾å¤¢æƒ³ï¼Œçœ‹ç¾é‡‘æµæ˜¯å¦ç‚ºæ­£
            yearsJob = jobSurplus >= 0 ? 0 : 99; 
        }

        // B. åŠ ä¸Šå®‰éº—é”æˆå¹´é½¡
        let totalSurplus = annualSurplus;
        let yearsAmway = 99;
        if (dreamFullTarget > 0) {
            if (totalSurplus > 0) yearsAmway = Math.ceil((dreamFullTarget - currentAssets) / totalSurplus);
        } else {
            yearsAmway = totalSurplus >= 0 ? 0 : 99;
        }

        // æ›´æ–° UI å¹´é½¡
        updateAgeUI('age-job-only', yearsJob, age);
        updateAgeUI('age-with-amway', yearsAmway, age);

        // 7. è˜ä½å»ºè­°
        // ç¼ºå£ = è² çš„ç¾é‡‘æµ OR ç‚ºäº†åŠ é€Ÿå¤¢æƒ³éœ€è¦çš„éŒ¢
        let pinBox = document.getElementById('pin-box');
        let gap = 0;
        
        if (totalSurplus < 0) {
            gap = Math.abs(totalSurplus); // è£œè¶³èµ¤å­—
        } else if (yearsAmway > 10 && dreamFullTarget > 0) {
            // å¦‚æœè¦å­˜è¶…é10å¹´ï¼Œå»ºè­°åŠ é€Ÿï¼Œç›®æ¨™å¹´å­˜ 10% å¤¢æƒ³é¡
            gap = (dreamFullTarget / 10) - totalSurplus; 
        }

        if (gap > 0) {
            pinBox.style.display = 'flex';
            let targetPin = AMWAY_PINS.find(p => p.income >= gap);
            if (!targetPin) targetPin = AMWAY_PINS[AMWAY_PINS.length-1]; // æœ€é«˜
            
            document.getElementById('pin-title').innerText = `å»ºè­°ç›®æ¨™ï¼š${targetPin.name}`;
            document.getElementById('pin-desc').innerText = `å¡«è£œ ${gap.toFixed(1)}è¬/å¹´ ç¼ºå£ï¼Œè®“å¤¢æƒ³ææ—©å¯¦ç¾ï¼`;
            document.getElementById('pin-icon').innerText = targetPin.icon;
        } else if (totalSurplus > 0 && yearsAmway === 0) {
            pinBox.style.display = 'flex';
            document.getElementById('pin-title').innerText = `è²¡å‹™å¥åº·ï¼šç¾é‡‘æµç‚ºæ­£`;
            document.getElementById('pin-desc').innerText = `æ­å–œï¼æ‚¨çš„è¦åŠƒå·²èƒ½æ”¯æ’å¤¢æƒ³ã€‚`;
            document.getElementById('pin-icon').innerText = "ğŸ‰";
        } else {
            pinBox.style.display = 'none';
        }
    }

    function updateAgeUI(id, years, currentAge) {
        let el = document.getElementById(id);
        if (years === 0) el.innerText = "ç«‹å³é”æˆ";
        else if (years > 60) el.innerText = "é™é™ç„¡æœŸ";
        else el.innerText = `${currentAge + years} æ­²`;
    }

    // è¼”åŠ©å‡½æ•¸
    function getVal(id) { return Number(document.getElementById(id).value) || 0; }
    function getUnit(id) { return document.getElementById(id).value; }

    // å‹•æ…‹æ–°å¢åˆ—
    function addDreamRow() {
        let div = document.createElement('div'); div.className = 'dynamic-row dream-row dream-item';
        div.innerHTML = `
            <button class="btn-remove" onclick="this.parentElement.remove();calculate()">&times;</button>
            <div class="row g-2 align-items-center">
                <div class="col-5">
                    <select class="form-select form-select-sm dream-cat" onchange="calculate()">
                        <option value="house">ğŸ  è²·æˆ¿ (è²¸30å¹´)</option>
                        <option value="car">ğŸš— è²·è»Š (è²¸7å¹´)</option>
                        <option value="travel">âœˆï¸ æ—…éŠ (å…¨æ¬¾)</option>
                        <option value="learn">ğŸ“š é€²ä¿® (å…¨æ¬¾)</option>
                        <option value="biz">ğŸ’¼ é–‹å…¬å¸ (å…¨æ¬¾)</option>
                        <option value="custom_loan">ğŸ’³ å…¶ä»– (è²¸5å¹´)</option>
                        <option value="other">âœ¨ å…¶ä»– (å…¨æ¬¾)</option>
                    </select>
                </div>
                <div class="col-7">
                    <div class="input-group input-group-sm">
                        <input type="number" class="form-control dream-cost" placeholder="ç¸½åƒ¹(è¬)" oninput="calculate()">
                        <span class="input-group-text">è¬</span>
                    </div>
                </div>
                <div class="col-12 dream-hint text-end"></div>
            </div>`;
        document.getElementById('dream-container').appendChild(div);
    }

    function addLoanRow() {
        let div = document.createElement('div'); div.className = 'dynamic-row loan-row loan-item';
        div.innerHTML = `
            <button class="btn-remove" onclick="this.parentElement.remove();calculate()">&times;</button>
            <div class="d-flex align-items-center justify-content-between">
                <span class="small fw-bold text-danger">æœˆä»˜é‡‘</span>
                <div class="input-group input-group-sm w-50">
                    <input type="number" class="form-control loan-m" placeholder="è¬" oninput="calculate()">
                    <span class="input-group-text">è¬</span>
                </div>
            </div>`;
        document.getElementById('loan-container').appendChild(div);
    }

    function addInsRow() {
        let div = document.createElement('div'); div.className = 'dynamic-row ins-row ins-item';
        div.innerHTML = `
            <button class="btn-remove" onclick="this.parentElement.remove();calculate()">&times;</button>
            <div class="row g-2">
                <div class="col-6">
                    <div class="input-group input-group-sm">
                        <input type="number" class="form-control ins-amt" placeholder="é‡‘é¡(è¬)" oninput="calculate()">
                    </div>
                </div>
                <div class="col-6">
                    <select class="form-select form-select-sm ins-type" onchange="calculate()">
                        <option value="year">å¹´ç¹³</option>
                        <option value="month">æœˆç¹³</option>
                    </select>
                </div>
            </div>`;
        document.getElementById('insurance-container').appendChild(div);
    }

    function saveData() { alert('âœ… å¤¢æƒ³è—åœ–å·²ä¿å­˜ï¼'); }
</script>
</body>
</html>

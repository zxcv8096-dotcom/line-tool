<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤§å¿ƒè²¡å¯Œé ˜èˆªç³»çµ± - æå˜‰å“²Gavin</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-color: #4A90E2; /* èˆ’é©çš„è—è‰² */
            --accent-color: #FF6B6B; /* äº®çœ¼çš„ç²‰ç´…/ç´…è‰²ï¼Œå‘¼æ‡‰å¤§å¿ƒ */
            --bg-color: #F7F9FC;
            --card-bg: #FFFFFF;
            --text-color: #333333;
        }

        body {
            font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        .subtitle {
            color: #666;
            font-size: 0.9em;
        }

        .card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }

        h2 {
            border-left: 5px solid var(--accent-color);
            padding-left: 15px;
            margin-top: 0;
            font-size: 1.3em;
            color: #444;
        }

        .input-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-control {
            margin-bottom: 10px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            font-size: 0.95em;
        }

        input, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            box-sizing: border-box;
            background-color: #fafafa;
        }

        input:focus {
            border-color: var(--primary-color);
            outline: none;
            background-color: #fff;
        }

        .unit-tag {
            font-size: 0.8em;
            color: #888;
            text-align: right;
            margin-top: -30px;
            margin-right: 10px;
            margin-bottom: 15px;
            pointer-events: none;
            position: relative;
        }

        button.calculate-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1em;
            border-radius: 50px;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        button.calculate-btn:hover {
            background-color: #357ABD;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(74, 144, 226, 0.3);
        }

        .result-section {
            display: none; /* Hidden by default */
            animation: fadeIn 0.5s;
        }

        .highlight-box {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 20px;
        }

        .status-badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            color: white;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .status-freedom { background-color: #4CAF50; }
        .status-working { background-color: #FF9800; }

        .amway-chart-container {
            margin-top: 20px;
            position: relative;
            height: 300px;
        }

        .footer {
            text-align: center;
            margin-top: 40px;
            color: #999;
            font-size: 0.8em;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .amway-levels {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }
        
        .level-card {
            background: #fff;
            border: 1px solid #eee;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            font-size: 0.9em;
            flex: 1 0 21%;
        }
        .level-card strong { display: block; color: var(--accent-color); }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>ğŸ’– å¤§å¿ƒè²¡å¯Œé ˜èˆªç³»çµ±</h1>
        <div class="subtitle">ç‚ºä½ é‡èº«æ‰“é€ çš„è²¡å¯Œè‡ªç”±è—åœ–</div>
    </header>

    <div class="card">
        <h2>1. è¨­å®šå¤¢æƒ³ç›®æ¨™ (å–®ä½ï¼šè¬å…ƒ)</h2>
        <div class="input-group">
            <div class="form-control">
                <label>ç›®å‰çš„å¹´é½¡</label>
                <input type="number" id="currentAge" value="30">
            </div>
            <div class="form-control">
                <label>å¤¢æƒ³ç¸½è³‡ç”¢ç›®æ¨™</label>
                <input type="number" id="dreamGoal" value="3000" placeholder="ä¾‹å¦‚ï¼š3000">
                <div class="unit-tag">è¬å…ƒ</div>
            </div>
            <div class="form-control">
                <label>ç›®å‰å·²ç´¯ç©æ·¨è³‡ç”¢</label>
                <input type="number" id="currentAssets" value="200">
                <div class="unit-tag">è¬å…ƒ</div>
            </div>
        </div>
        <div class="input-group">
            <div class="form-control">
                <label>é ä¼°é€šè²¨è†¨è„¹ç‡ (%)</label>
                <input type="number" id="inflationRate" value="2.5" step="0.1">
            </div>
        </div>
    </div>

    <div class="card">
        <h2>2. æ”¶å…¥çµæ§‹ (å¹´æ”¶å…¥/å–®ä½ï¼šè¬å…ƒ)</h2>
        <h3>ğŸ’¼ ä¸»å‹•æ”¶å…¥ (éœ€èª²ç¨…)</h3>
        <div class="input-group">
            <div class="form-control">
                <label>æœ¬æ¥­è–ªè³‡</label>
                <input type="number" id="salary" value="100">
                <div class="unit-tag">è¬å…ƒ</div>
            </div>
            <div class="form-control">
                <label>å‰¯æ¥­/å…¶ä»–ä¸»å‹•</label>
                <input type="number" id="sideHustle" value="0">
                <div class="unit-tag">è¬å…ƒ</div>
            </div>
        </div>

        <h3>ğŸ“ˆ è¢«å‹•æ”¶å…¥</h3>
        <div class="input-group">
            <div class="form-control">
                <label>è‚¡ç¥¨/åŸºé‡‘é…æ¯ (æµ·å¤–)</label>
                <input type="number" id="stockDiv" value="20" placeholder="ç¾è‚¡ETFç­‰">
                <div class="unit-tag">è¬å…ƒ</div>
                <small style="color:#888; font-size:0.8em;">*æµ·å¤–æ‰€å¾—750è¬å…§å…ç¨…</small>
            </div>
            <div class="form-control">
                <label>æˆ¿ç§Ÿæ”¶å…¥</label>
                <input type="number" id="rentIncome" value="0">
                <div class="unit-tag">è¬å…ƒ</div>
            </div>
            <div class="form-control">
                <label>ç›®å‰å®‰éº—æ”¶å…¥ (å¹´)</label>
                <input type="number" id="currentAmway" value="0">
                <div class="unit-tag">è¬å…ƒ</div>
            </div>
            <div class="form-control">
                <label>å…¶ä»–è¢«å‹•æ”¶å…¥</label>
                <input type="number" id="otherPassive" value="0">
                <div class="unit-tag">è¬å…ƒ</div>
            </div>
        </div>
    </div>

    <div class="card">
        <h2>3. æœˆæ”¯å‡ºçµæ§‹ (å–®ä½ï¼šè¬å…ƒ/æœˆ)</h2>
        <div class="input-group">
            <div class="form-control">
                <label>æˆ¿è²¸/æˆ¿ç§Ÿ</label>
                <input type="number" id="expHousing" value="3">
                <div class="unit-tag">è¬å…ƒ/æœˆ</div>
            </div>
            <div class="form-control">
                <label>è»Šè²¸/äº¤é€š</label>
                <input type="number" id="expCar" value="1.5">
                <div class="unit-tag">è¬å…ƒ/æœˆ</div>
            </div>
            <div class="form-control">
                <label>ä¿éšªè²»</label>
                <input type="number" id="expIns" value="0.5">
                <div class="unit-tag">è¬å…ƒ/æœˆ</div>
            </div>
            <div class="form-control">
                <label>ç”Ÿæ´»/å…¶ä»–</label>
                <input type="number" id="expLife" value="2">
                <div class="unit-tag">è¬å…ƒ/æœˆ</div>
            </div>
        </div>
    </div>

    <div class="card">
        <h2>4. å®‰éº—äº‹æ¥­è¦åŠƒ</h2>
        <label>é¸æ“‡æ‚¨æƒ³æŒ‘æˆ°çš„ç›®æ¨™è˜ä½ï¼Œçœ‹çœ‹èƒ½å¿«å¹¾å¹´é€€ä¼‘ï¼š</label>
        <select id="targetAmwayLevel" style="margin-top:10px; font-weight:bold; color:var(--primary-color);">
            <option value="0">-- è«‹é¸æ“‡ç›®æ¨™è˜ä½ --</option>
            <option value="100">ç™½é‡‘ (å¹´æ”¶ç´„ 100è¬)</option>
            <option value="180">è—å¯¶çŸ³ (å¹´æ”¶ç´„ 180è¬)</option>
            <option value="250">ç¿¡ç¿  (å¹´æ”¶ç´„ 250è¬)</option>
            <option value="500">é‘½çŸ³ (å¹´æ”¶ç´„ 500è¬)</option>
            <option value="700">åŸ·è¡Œå°ˆæ‰ EDC (å¹´æ”¶ç´„ 700è¬)</option>
            <option value="1000">çš‡å†  (å¹´æ”¶ç´„ 1000è¬)</option>
            <option value="3000">çš‡å† å¤§ä½¿ (å¹´æ”¶ç´„ 3000è¬)</option>
        </select>
        
        <div class="amway-levels">
            <div class="level-card"><strong>ç™½é‡‘</strong>100è¬</div>
            <div class="level-card"><strong>ç¿¡ç¿ </strong>250è¬</div>
            <div class="level-card"><strong>é‘½çŸ³</strong>500è¬</div>
            <div class="level-card"><strong>çš‡å† </strong>1000è¬</div>
        </div>
    </div>

    <button class="calculate-btn" onclick="calculateFreedom()">ğŸš€ é–‹å§‹è¨ˆç®—è²¡å¯Œè‡ªç”±è·¯å¾‘</button>

    <div id="resultSection" class="result-section card" style="margin-top: 20px;">
        <h2 style="border-color: #4CAF50;">ğŸ“Š åˆ†æçµæœ</h2>
        
        <div class="highlight-box">
            <div id="freedomStatus" class="status-badge status-working">å°šæœªè‡ªç”±</div>
            <div style="font-size: 1.2em; margin-bottom: 10px;">
                ç›®å‰è¢«å‹•æ”¶å…¥æ¶µè“‹ç‡ï¼š<span id="coverageRatio" style="font-weight:bold; font-size:1.4em;">0%</span>
            </div>
            <div>
                å¹´ç¸½æ”¯å‡ºï¼š<span id="totalAnnualExp">0</span> è¬ | å¹´ç¸½è¢«å‹•æ”¶å…¥ï¼š<span id="totalPassive">0</span> è¬
            </div>
        </div>

        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:20px;">
            <div>
                <h3>ğŸ¢ ç¶­æŒç¾ç‹€</h3>
                <p>è‹¥ä¸æ”¹è®Šï¼Œé è¨ˆé”æˆå¤¢æƒ³å¹´é½¡ï¼š</p>
                <div id="ageCurrent" style="font-size:2em; font-weight:bold; color:#666;">-- æ­²</div>
                <p style="font-size:0.8em; color:#888;">(è€ƒé‡é€šè†¨èˆ‡ç¾æœ‰å„²è“„ç‡)</p>
            </div>
            <div>
                <h3>ğŸ° åŠ ä¸Šå®‰éº—ç›®æ¨™ (<span id="targetLevelName">--</span>)</h3>
                <p>é”æˆå¤¢æƒ³å¹´é½¡ç¸®çŸ­è‡³ï¼š</p>
                <div id="ageAmway" style="font-size:2.5em; font-weight:bold; color:var(--accent-color);">-- æ­²</div>
                <p style="font-size:0.9em; color:#4CAF50; font-weight:bold;">ææ—© <span id="yearsSaved">0</span> å¹´å¯¦ç¾å¤¢æƒ³ï¼</p>
            </div>
        </div>

        <div class="amway-chart-container">
            <canvas id="wealthChart"></canvas>
        </div>
    </div>

    <div class="footer">
        Made with â¤ï¸ by æå˜‰å“² Gavin | å¤§å¿ƒåœ˜éšŠ
    </div>
</div>

<script>
    let myChart = null;

    function calculateFreedom() {
        // 1. ç²å–æ•¸å€¼ (å–®ä½ï¼šè¬)
        const currentAge = parseFloat(document.getElementById('currentAge').value) || 0;
        const dreamGoal = parseFloat(document.getElementById('dreamGoal').value) || 0;
        const currentAssets = parseFloat(document.getElementById('currentAssets').value) || 0;
        const inflationRate = (parseFloat(document.getElementById('inflationRate').value) || 0) / 100;

        // æ”¶å…¥
        const salary = parseFloat(document.getElementById('salary').value) || 0;
        const sideHustle = parseFloat(document.getElementById('sideHustle').value) || 0;
        const stockDiv = parseFloat(document.getElementById('stockDiv').value) || 0; // æµ·å¤–
        const rentIncome = parseFloat(document.getElementById('rentIncome').value) || 0;
        const currentAmway = parseFloat(document.getElementById('currentAmway').value) || 0;
        const otherPassive = parseFloat(document.getElementById('otherPassive').value) || 0;

        // æ”¯å‡º (æœˆè½‰å¹´)
        const monthlyExp = (
            parseFloat(document.getElementById('expHousing').value) || 0 +
            parseFloat(document.getElementById('expCar').value) || 0 +
            parseFloat(document.getElementById('expIns').value) || 0 +
            parseFloat(document.getElementById('expLife').value) || 0
        );
        const annualExp = monthlyExp * 12;

        // ç›®æ¨™å®‰éº—æ”¶å…¥
        const targetAmwaySelect = document.getElementById('targetAmwayLevel');
        const targetAmwayIncome = parseFloat(targetAmwaySelect.value) || 0;
        const targetLevelName = targetAmwaySelect.options[targetAmwaySelect.selectedIndex].text.split(' ')[0];

        // 2. ç¨…å‹™è¨ˆç®— (ç°¡æ˜“ç‰ˆé‚è¼¯)
        // å‡è¨­å¢ƒå…§æ‰€å¾—ç¨…ç‡å¹³å‡ç‚º 12% (ç¶œåˆæ‰€å¾—ç¨…æ¦‚ç®—)ï¼Œæµ·å¤–æ‰€å¾— < 750è¬å…ç¨…
        const domesticIncome = salary + sideHustle + rentIncome + otherPassive + currentAmway;
        const taxDomestic = domesticIncome * 0.12; // ç°¡æ˜“æ‰£é™¤
        
        let taxOverseas = 0;
        if (stockDiv > 100 && (stockDiv + domesticIncome) > 750) {
            taxOverseas = (stockDiv - 670) * 0.2; // åŸºæœ¬ç¨…é¡ç°¡æ˜“é‚è¼¯ï¼Œåƒ…ä¾›åƒè€ƒ
            if(taxOverseas < 0) taxOverseas = 0;
        }

        const totalTax = taxDomestic + taxOverseas;

        // 3. æ·¨ç¾é‡‘æµè¨ˆç®—
        const totalPassive = stockDiv + rentIncome + currentAmway + otherPassive;
        const netAnnualIncomeCurrent = (domesticIncome + stockDiv) - totalTax - annualExp;
        
        // åŠ ä¸Šå®‰éº—ç›®æ¨™å¾Œçš„æ”¶å…¥ (å‡è¨­å®‰éº—æ”¶å…¥å¢åŠ éƒ¨åˆ†)
        // å¢åŠ çš„è¢«å‹•æ”¶å…¥ = ç›®æ¨™å®‰éº—æ”¶å…¥ - ç›®å‰å®‰éº—æ”¶å…¥ (è‹¥ç›®æ¨™ < ç›®å‰ï¼Œå‰‡ä¸å¢åŠ )
        let addedAmwayIncome = targetAmwayIncome - currentAmway;
        if (addedAmwayIncome < 0) addedAmwayIncome = 0;
        
        // å®‰éº—å¢åŠ æ”¶å…¥çš„ç¨… (å‡è¨­ä½µå…¥ç¶œæ‰€ç¨…ï¼Œé‚Šéš›ç¨…ç‡ä¼°20%)
        const amwayTax = addedAmwayIncome * 0.2; 
        const netAnnualIncomeWithAmway = netAnnualIncomeCurrent + addedAmwayIncome - amwayTax;

        // 4. è²¡å¯Œè‡ªç”±åˆ¤å®š (è¢«å‹• > æ”¯å‡º)
        const coverageRatio = (totalPassive / annualExp * 100).toFixed(1);
        const statusBadge = document.getElementById('freedomStatus');
        
        if (totalPassive >= annualExp) {
            statusBadge.textContent = "æ­å–œï¼å·²è²¡å¯Œè‡ªç”±";
            statusBadge.className = "status-badge status-freedom";
        } else {
            statusBadge.textContent = "åŠªåŠ›ä¸­";
            statusBadge.className = "status-badge status-working";
        }

        // 5. é”æˆç›®æ¨™å¹´æ•¸è¨ˆç®— (å«è¤‡åˆ©/é€šè†¨ç°¡æ˜“æ¨¡æ“¬)
        function calculateYears(startAssets, annualSaving, goal, infl) {
            let assets = startAssets;
            let years = 0;
            // è¨­å®šä¸Šé™é¿å…ç„¡çª®è¿´åœˆ
            while (assets < goal && years < 80) {
                assets = assets * (1.05) + annualSaving; // å‡è¨­è³‡ç”¢æœ¬èº«æœ‰5%æŠ•è³‡å›å ±
                // é€šè†¨å°è‡´ç›®æ¨™å¯¦è³ªè³¼è²·åŠ›éœ€æ±‚å¢åŠ ï¼Œé€™è£¡ç°¡åŒ–ç‚ºç›®æ¨™é‡‘é¡ä¸è®Šï¼Œä½†å„²è“„åŠ›ç›¸å°è¢«é€šè†¨ä¾µè•
                // æˆ–æ˜¯æ›´ç°¡å–®ï¼šè³‡ç”¢å¢é•· vs å›ºå®šç›®æ¨™
                years++;
            }
            return years;
        }
        
        // é€™è£¡æ¡ç”¨ã€Œéœ€è¦ç´¯ç©åˆ°çš„é‡‘é¡ã€æœƒéš¨é€šè†¨å¢åŠ çš„é‚è¼¯æœƒæ¯”è¼ƒæº–ç¢º
        // ä½†ç‚ºäº†ç›´è§€ï¼Œæˆ‘å€‘è¨ˆç®—ï¼š(ç›®æ¨™ - ç¾æœ‰) / å¹´å„²è“„ï¼Œä¸¦å°å„²è“„åšæŠ•è³‡å›å ±åŠ æˆ
        
        const yearsCurrent = calculateYearsToGoal(currentAssets, netAnnualIncomeCurrent, dreamGoal);
        const yearsWithAmway = calculateYearsToGoal(currentAssets, netAnnualIncomeWithAmway, dreamGoal);

        // 6. æ›´æ–°UI
        document.getElementById('resultSection').style.display = 'block';
        document.getElementById('coverageRatio').textContent = coverageRatio + "%";
        document.getElementById('totalAnnualExp').textContent = annualExp.toFixed(1);
        document.getElementById('totalPassive').textContent = totalPassive.toFixed(1);
        
        document.getElementById('ageCurrent').textContent = (yearsCurrent > 90) ? "> 100 æ­²" : (currentAge + yearsCurrent) + " æ­²";
        
        document.getElementById('targetLevelName').textContent = targetLevelName == "--" ? "æœªé¸æ“‡" : targetLevelName;
        
        if (targetAmwayIncome > 0) {
            document.getElementById('ageAmway').textContent = (currentAge + yearsWithAmway) + " æ­²";
            document.getElementById('yearsSaved').textContent = (yearsCurrent - yearsWithAmway > 0) ? (yearsCurrent - yearsWithAmway) : 0;
        } else {
            document.getElementById('ageAmway').textContent = "-- æ­²";
            document.getElementById('yearsSaved').textContent = "0";
        }

        // 7. ç¹ªè£½åœ–è¡¨
        drawChart(currentAge, yearsCurrent, yearsWithAmway, dreamGoal);
        
        // æ»¾å‹•åˆ°çµæœ
        document.getElementById('resultSection').scrollIntoView({behavior: 'smooth'});
    }

    function calculateYearsToGoal(current, annualSaving, goal) {
        if (annualSaving <= 0) return 999; // æ°¸é é”ä¸åˆ°
        let assets = current;
        let years = 0;
        while (assets < goal && years < 100) {
            assets = assets * 1.06 + annualSaving; // å‡è¨­è³‡ç”¢å¹´åŒ–å ±é…¬ç‡ 6%
            years++;
        }
        return years;
    }

    function drawChart(startAge, yearsA, yearsB, goal) {
        const ctx = document.getElementById('wealthChart').getContext('2d');
        
        if (myChart) myChart.destroy();

        // é™åˆ¶é¡¯ç¤ºé•·åº¦
        const maxYears = Math.min(Math.max(yearsA, yearsB) + 5, 50);
        const labels = [];
        const dataA = [];
        const dataB = [];
        
        for (let i = 0; i <= maxYears; i++) {
            labels.push(startAge + i + "æ­²");
            // ç°¡å–®æ¨¡æ“¬æ›²ç·šä¾›è¦–è¦ºåƒè€ƒ
            dataA.push(Math.min(goal, (i / yearsA) * goal)); 
            dataB.push(Math.min(goal, (i / yearsB) * goal));
        }

        myChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: labels,
                datasets: [{
                    label: 'ç¶­æŒç¾ç‹€ è³‡ç”¢ç´¯ç©',
                    data: dataA,
                    borderColor: '#ccc',
                    borderWidth: 2,
                    fill: false,
                    pointRadius: 0
                }, {
                    label: 'åŠ ä¸Šå®‰éº—äº‹æ¥­ è³‡ç”¢ç´¯ç©',
                    data: dataB,
                    borderColor: '#FF6B6B', // å¤§å¿ƒ accent color
                    borderWidth: 3,
                    fill: false,
                    pointRadius: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'è³‡ç”¢ç´¯ç©é€Ÿåº¦æ¯”è¼ƒåœ–'
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: { display: true, text: 'ç´¯ç©è³‡ç”¢ (è¬å…ƒ)' }
                    }
                }
            }
        });
    }
</script>

</body>
</html>

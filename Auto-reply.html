<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI å¼•æµé›²ç«¯å¤§è…¦ V2.0 ğŸ‘‘</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .gradient-bg { background: linear-gradient(135deg, #0f172a, #312e81, #581c87); }
        .platform-tag { @apply px-2 py-0.5 rounded text-[10px] font-bold uppercase; }
    </style>
</head>
<body class="bg-slate-50 font-sans text-slate-900">

    <nav class="gradient-bg p-5 text-white shadow-2xl sticky top-0 z-50">
        <div class="container mx-auto flex justify-between items-center">
            <div>
                <h1 class="text-xl font-black italic">META AI FLOW V2.0 ğŸš€</h1>
                <p class="text-[9px] text-yellow-400 font-bold uppercase">Cloud & Account Management System</p>
            </div>
            <div class="text-right border-l pl-4 border-white/10">
                <p class="text-xs font-bold text-yellow-400">2026 æ·¨è³‡ç”¢ 700 è¬ç›®æ¨™ ğŸ’°</p>
                <p class="text-[9px]">çš‡å† å¤§ä½¿ä¹‹è·¯ | 2è¬äººæ¼”è¬› ğŸ‘‘</p>
            </div>
        </div>
    </nav>

    <div class="container mx-auto p-4 md:p-6 max-w-7xl">
        <div class="grid lg:grid-cols-4 gap-6">
            
            <div class="lg:col-span-1 space-y-6">
                <div class="bg-indigo-900 p-6 rounded-3xl text-white shadow-xl">
                    <h3 class="text-xs font-bold text-indigo-300 uppercase mb-4 tracking-widest">ğŸ” å¸³è™Ÿç®¡ç†</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="text-[10px] opacity-70">å¸³è™Ÿè­˜åˆ¥ç¢¼ (Access Key)</label>
                            <input id="accountKey" type="text" placeholder="è¼¸å…¥å¸³è™Ÿ ID" class="w-full bg-white/10 border border-white/20 rounded-xl p-3 text-sm mt-1 outline-none focus:bg-white/20" value="default_user">
                        </div>
                        <button onclick="syncFromCloud()" class="w-full bg-white text-indigo-900 font-bold py-2 rounded-xl text-xs hover:bg-yellow-400 transition">åˆ‡æ›ä¸¦åŒæ­¥é›²ç«¯è³‡æ–™</button>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-3xl shadow-xl border border-slate-100">
                    <h2 class="text-sm font-bold mb-4 flex items-center gap-2">ğŸ“ ç³»çµ±ç‰ˆæœ¬æ¬¡åº</h2>
                    <div class="space-y-3 relative text-[11px]">
                        <div class="relative pl-6 border-l-2 border-green-500 ml-1">
                            <span class="absolute -left-[7px] top-1 w-3 h-3 bg-green-500 rounded-full"></span>
                            <h4 class="font-bold text-green-600">V1.8 å¤šé‡é™„ä»¶åŠŸèƒ½ âœ…</h4>
                        </div>
                        <div class="relative pl-6 border-l-2 border-blue-500 ml-1">
                            <span class="absolute -left-[7px] top-1 w-3 h-3 bg-blue-500 rounded-full animate-pulse"></span>
                            <h4 class="font-bold text-blue-700">V2.0 é›²ç«¯å¸³è™ŸåŒæ­¥ ğŸ†•</h4>
                            <p class="text-[9px] text-slate-400">æ”¯æ´æ‰‹æ©Ÿ/é›»è…¦è·¨å¸³è™Ÿå…±ç”¨</p>
                        </div>
                        <div class="relative pl-6 border-l-2 border-slate-200 ml-1">
                            <span class="absolute -left-[7px] top-1 w-3 h-3 bg-slate-200 rounded-full"></span>
                            <h4 class="font-bold text-slate-400">V3.0 Meta æ¬Šé™å°æ¥ â³</h4>
                        </div>
                    </div>
                </div>
            </div>

            <div class="lg:col-span-3 space-y-6">
                <div class="bg-white p-6 md:p-8 rounded-3xl shadow-xl border border-slate-100">
                    <div class="flex justify-between items-center mb-6 border-b pb-4">
                        <h2 class="text-xl font-black text-slate-800 tracking-tight">è‡ªå‹•å¼•æµè¦å‰‡ç·¨è¼¯</h2>
                        <span id="syncStatus" class="text-[10px] bg-green-100 text-green-600 px-3 py-1 rounded-full font-bold">â— å·²å°±ç·’</span>
                    </div>
                    
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="space-y-4">
                            <div>
                                <label class="block text-xs font-bold text-slate-500 mb-2 uppercase">1. é©ç”¨å¹³å°</label>
                                <div class="flex flex-wrap gap-2">
                                    <label class="flex items-center gap-2 bg-slate-50 px-3 py-1.5 rounded-xl border text-xs cursor-pointer"><input type="checkbox" name="platform" value="FB" checked> FB</label>
                                    <label class="flex items-center gap-2 bg-slate-50 px-3 py-1.5 rounded-xl border text-xs cursor-pointer"><input type="checkbox" name="platform" value="IG" checked> IG</label>
                                    <label class="flex items-center gap-2 bg-slate-50 px-3 py-1.5 rounded-xl border text-xs cursor-pointer"><input type="checkbox" name="platform" value="TikTok"> TikTok</label>
                                </div>
                            </div>
                            <div>
                                <label class="block text-xs font-bold text-slate-500 mb-2 uppercase">2. é—œéµå­—</label>
                                <input id="keyword" type="text" placeholder="é ˜å–æ–¹æ¡ˆ..." class="w-full bg-slate-50 border rounded-2xl p-3 text-sm outline-none focus:ring-2 ring-indigo-500/20">
                            </div>
                            <div class="bg-indigo-50 p-4 rounded-2xl">
                                <label class="block text-xs font-bold text-indigo-900 mb-2 uppercase">3. é™„åŠ åª’é«”</label>
                                <div class="flex gap-2">
                                    <select id="msgType" class="bg-white border rounded-xl px-2 py-1 text-[10px]"><option value="image">åœ–ç‰‡</option><option value="video">å½±ç‰‡</option></select>
                                    <input id="mediaUrl" type="text" placeholder="URL..." class="flex-1 bg-white border rounded-xl px-3 py-1 text-[10px]">
                                    <button onclick="addAttachment()" class="bg-indigo-600 text-white px-3 rounded-xl">ï¼‹</button>
                                </div>
                                <div id="tempAttachList" class="mt-2 space-y-1"></div>
                            </div>
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-slate-500 mb-2 uppercase">4. æ„Ÿæ€§å›è¦†æ–‡æ¡ˆ</label>
                            <textarea id="replyText" rows="9" placeholder="å¯«ä¸‹å°æœ‹å‹çš„æº«æš–å›è¦†..." class="w-full bg-slate-50 border rounded-2xl p-4 text-sm outline-none focus:ring-2 ring-indigo-500/20"></textarea>
                        </div>
                    </div>

                    <button onclick="addRule()" class="mt-6 w-full gradient-bg text-white font-bold py-4 rounded-2xl shadow-xl hover:opacity-90 transition transform active:scale-95">
                        å„²å­˜ä¸¦åŒæ­¥è‡³é›²ç«¯ ğŸ’¾
                    </button>
                </div>

                <div class="bg-white p-6 rounded-3xl shadow-xl border border-slate-100">
                    <h3 class="font-bold text-slate-800 mb-4 text-sm uppercase tracking-widest">ğŸ“‹ ç›®å‰å¸³è™Ÿè¦å‰‡</h3>
                    <div id="ruleList" class="grid md:grid-cols-2 gap-4"></div>
                </div>

                <div class="bg-slate-900 p-6 rounded-3xl shadow-2xl border-t-8 border-indigo-500">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-indigo-400 font-mono text-xs font-bold uppercase tracking-widest">// GAS ç³»çµ±ä»£ç¢¼è¼¸å‡º</h2>
                        <button onclick="copyCode()" class="bg-indigo-600 text-white px-4 py-1 rounded-full text-[10px] font-bold">è¤‡è£½</button>
                    </div>
                    <pre id="outputCode" class="text-indigo-300 font-mono text-[9px] overflow-x-auto leading-loose max-h-[200px]">const REPLY_RULES = [];</pre>
                </div>
            </div>
        </div>
    </div>

    <script>
        let rules = [];
        let tempAttachments = [];

        // æ¨¡æ“¬è·¨å¸³è™Ÿè®€å– (ç›®å‰æš«å­˜ localStorageï¼Œå¾… V2.1 ä¸²æ¥ GAS ç¶²å€)
        function syncFromCloud() {
            const key = document.getElementById('accountKey').value;
            const savedData = localStorage.getItem('rules_' + key);
            rules = savedData ? JSON.parse(savedData) : [];
            renderUI();
            alert('å¸³è™Ÿ [' + key + '] è³‡æ–™åŒæ­¥æˆåŠŸï¼');
        }

        function addAttachment() {
            const type = document.getElementById('msgType').value;
            const url = document.getElementById('mediaUrl').value;
            if(!url) return;
            tempAttachments.push({ type, url });
            renderTempAttachments();
            document.getElementById('mediaUrl').value = '';
        }

        function renderTempAttachments() {
            document.getElementById('tempAttachList').innerHTML = tempAttachments.map((a, i) => `
                <div class="bg-white p-2 rounded-lg flex justify-between items-center text-[9px] shadow-sm">
                    <span class="font-bold text-indigo-600">[${a.type.toUpperCase()}]</span>
                    <span class="truncate flex-1 mx-2 opacity-50">${a.url}</span>
                    <button onclick="tempAttachments.splice(${i},1);renderTempAttachments()" class="text-red-400">âŒ</button>
                </div>`).join('');
        }

        function addRule() {
            const kw = document.getElementById('keyword').value;
            const text = document.getElementById('replyText').value;
            const key = document.getElementById('accountKey').value;
            const platforms = Array.from(document.querySelectorAll('input[name="platform"]:checked')).map(cb => cb.value);

            if(!kw || !text || platforms.length === 0) return alert('è³‡æ–™ä¸å…¨ï¼');

            rules.push({ platforms, "keyword": kw, text, "attachments": [...tempAttachments] });
            localStorage.setItem('rules_' + key, JSON.stringify(rules));
            
            renderUI();
            document.getElementById('keyword').value = '';
            document.getElementById('replyText').value = '';
            tempAttachments = [];
            renderTempAttachments();
        }

        function renderUI() {
            const list = document.getElementById('ruleList');
            list.innerHTML = rules.length === 0 ? '<p class="text-slate-400 text-center py-6 text-xs col-span-2">æ­¤å¸³è™Ÿç›®å‰ç„¡è³‡æ–™</p>' : '';
            rules.forEach((r, index) => {
                list.innerHTML += `
                    <div class="bg-slate-50 p-4 rounded-2xl border border-slate-200 relative">
                        <div class="flex gap-1 mb-2">
                            ${r.platforms.map(p => `<span class="platform-tag text-white ${p==='FB'?'bg-blue-600':'bg-pink-500'}">${p}</span>`).join('')}
                        </div>
                        <h4 class="font-bold text-xs text-indigo-800">${r.keyword}</h4>
                        <p class="text-[10px] text-slate-500 line-clamp-1 mt-1">${r.text}</p>
                        <button onclick="rules.splice(${index},1);localStorage.setItem('rules_'+document.getElementById('accountKey').value, JSON.stringify(rules));renderUI()" class="absolute top-4 right-4 text-slate-300">âŒ</button>
                    </div>`;
            });
            document.getElementById('outputCode').innerText = `const REPLY_RULES = ${JSON.stringify(rules, null, 2)};`;
        }

        window.onload = syncFromCloud;
    </script>
</body>
</html>
